(()=>{(()=>{"use strict";let S={"chevron-left-solid":'<svg viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path fill="currentColor" d="M15.7 4.3a1 1 0 0 0-1.4 0L7.6 11l6.7 6.7a1 1 0 1 0 1.4-1.4L10.4 11l5.3-5.3a1 1 0 0 0 0-1.4z"></path></svg>',"chevron-right-solid":'<svg viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path fill="currentColor" d="M8.3 4.3a1 1 0 0 1 1.4 0L16.4 11l-6.7 6.7a1 1 0 1 1-1.4-1.4L13.6 11 8.3 5.7a1 1 0 0 1 0-1.4z"></path></svg>',"circle-notch-light":'<svg viewBox="0 0 24 24" aria-hidden="true" focusable="false"><circle cx="12" cy="12" r="9" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-dasharray="45 10"></circle></svg>',"copy-regular":'<svg viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path fill="currentColor" d="M8 3a3 3 0 0 0-3 3v9h2V6a1 1 0 0 1 1-1h9V3z"></path><path fill="currentColor" d="M10 7a3 3 0 0 0-3 3v8a3 3 0 0 0 3 3h8a3 3 0 0 0 3-3v-8a3 3 0 0 0-3-3zm0 2h8a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1h-8a1 1 0 0 1-1-1v-8a1 1 0 0 1 1-1z"></path></svg>',"circle-check-solid":'<svg viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path fill="currentColor" d="M12 2a10 10 0 1 0 10 10A10.011 10.011 0 0 0 12 2zm4.7 8.3-5.4 5.4a1 1 0 0 1-1.4 0l-2.3-2.3a1 1 0 0 1 1.4-1.4l1.6 1.59 4.7-4.69a1 1 0 0 1 1.4 1.4z"></path></svg>'},d={isMobile:()=>window.matchMedia("(max-width: 649px)").matches,mediaQueries:{portraitOrientation:"(orientation: portrait)"},svg:t=>S[t]||"",notificationCenter:(()=>{let t=new Map;return{addHandlerForEvent(o,s){t.has(o)||t.set(o,new Set),t.get(o).add(s)},removeHandlerForEvent(o,s){let a=t.get(o);a&&(a.delete(s),a.size===0&&t.delete(o))},fireEvent(o,s={}){let a=t.get(o);a&&a.forEach(n=>{try{n(s)}catch(r){console.error(r)}})}}})(),defaultImageAuxText:""},p=new Map;function c(t,o,s=1){0<s||console.debug(`[${o}] ${t}`)}function b(t,{name:o}){if(!o)throw new Error("addMousemoveListener requires a name.");v(o);let s=a=>t(a);p.set(o,s),window.addEventListener("mousemove",s)}function v(t){let o=p.get(t);o&&(window.removeEventListener("mousemove",o),p.delete(t))}function y(t){let o=document.documentElement,s=document.body;t?(o.dataset.imageFocusScrollLock!==void 0&&(o.style.overflow=o.dataset.imageFocusScrollLock,delete o.dataset.imageFocusScrollLock),s.dataset.imageFocusScrollLock!==void 0&&(s.style.overflow=s.dataset.imageFocusScrollLock,delete s.dataset.imageFocusScrollLock)):o.dataset.imageFocusScrollLock||(o.dataset.imageFocusScrollLock=o.style.overflow||"",s.dataset.imageFocusScrollLock=s.style.overflow||"",o.style.overflow="hidden",s.style.overflow="hidden")}function x(t){let o=document.createElement("template");o.innerHTML=t.trim();let s=o.content.firstElementChild;return document.body.appendChild(s),s}function C(t,{ifMatchesOrAlwaysDo:o,callWhenAdd:s=!1}={}){let a=window.matchMedia(t),n=r=>{o(r)};return s&&o(a),a.addEventListener("change",n),()=>a.removeEventListener("change",n)}function k(t,o){let s=n=>o(n),a=n=>{(n.key==="Enter"||n.key===" ")&&(n.preventDefault(),o(n))};return t.addEventListener("click",s),t.addEventListener("keydown",a),()=>{t.removeEventListener("click",s),t.removeEventListener("keydown",a)}}Element.prototype.addActivateEvent||Object.defineProperty(Element.prototype,"addActivateEvent",{value(t){return k(this,t)}});function M(t,o,s,a,{cancelOnEvents:n=[]}={}){let r=null,i=u=>{r=window.setTimeout(()=>a(u),s)},l=()=>{r!==null&&(clearTimeout(r),r=null)};return t.addEventListener(o,i,{passive:!0}),n.forEach(u=>t.addEventListener(u,l,{passive:!0})),()=>{t.removeEventListener(o,i),n.forEach(u=>t.removeEventListener(u,l)),l()}}function h(t){try{return new URL(t,window.location.href)}catch(o){return new URL(window.location.href)}}function U({location:t}){let o=new Image;o.src=t}function F(t,o={},s={}){let a=document.createElement(t);return Object.entries(o||{}).forEach(([n,r])=>{r!=null&&a.setAttribute(n,r)}),Object.assign(a,s||{}),a}function A(t,o,{moveClasses:s=[],useExistingWrapper:a=!1}={}){let n=o.split("."),r=n.shift()||"div",i=n.filter(Boolean),l=t.parentElement;return l&&a&&l.tagName.toLowerCase()===r.toLowerCase()&&i.every(m=>l.classList.contains(m))||(l=document.createElement(r),i.length&&l.classList.add(...i),t.parentNode.insertBefore(l,t),l.appendChild(t)),s.forEach(m=>{t.classList.contains(m)&&(t.classList.remove(m),l.classList.add(m))}),l}function H(t){!t||typeof t.scrollIntoView!="function"||t.scrollIntoView({behavior:"smooth",block:"center"})}function w(t){history.replaceState?history.replaceState(null,"",t):window.location.assign(t)}function R(t){document.readyState==="complete"?t():window.addEventListener("load",t,{once:!0})}function D(t){return navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(t).catch(()=>L(t)):L(t)}function L(t){let o=document.createElement("textarea");o.value=t,o.style.position="fixed",o.style.top="-1000px",o.setAttribute("readonly",""),document.body.appendChild(o),o.focus(),o.select();try{document.execCommand("copy")}finally{document.body.removeChild(o)}return Promise.resolve()}let e={contentImagesSelector:[".markdownBody figure img"].join(", "),excludedContainerElementsSelector:["a","button","figure.image-focus-not"].join(", "),imageGalleryInclusionTest:t=>t.closest("#markdownBody")!=null&&t.closest(".footnotes")==null&&t.classList.contains("page-thumbnail")==!1,shrinkRatio:.975,hideUITimerDuration:d.isMobile()?5e3:3e3,dropShadowFilterForImages:"drop-shadow(10px 10px 10px #000) drop-shadow(0 0 10px #444)",hoverCaptionWidth:175,hoverCaptionHeight:75,fullSizeImageLoadHoverDelay:25,imageFocusUIElementsSelector:[".slideshow-button",".help-overlay",".image-number",".caption",".close-button"].join(", "),focusableImagesSelector:null,focusedImageSelector:null,galleryImagesSelector:null,hideUITimer:null,overlay:null,mouseLastMovedAt:0,currentlyFocusedImage:null,imageInFocus:null,savedHash:null,_dragStartMouseX:0,_dragStartMouseY:0,_dragStartImageX:0,_dragStartImageY:0,dragImageMouseMoveHandler:t=>{e.imageInFocus.style.filter="none",e.imageInFocus.style.left=e._dragStartImageX+t.clientX-e._dragStartMouseX+"px",e.imageInFocus.style.top=e._dragStartImageY+t.clientY-e._dragStartMouseY+"px"},setup:()=>{c("ImageFocus.setup","image-focus.js",1),e.overlay=x(`<div id="image-focus-overlay">
            <button type="button" class="close-button" tabindex="0" title="Close (Escape)">&times;</button>
            <div class="help-overlay">
                <p class="slideshow-help-text"><strong>Arrow keys:</strong> Next/previous image</p>
                <p><strong>Escape</strong> or <strong>click</strong>: Hide zoomed image</p>
                <p><strong>Space bar:</strong> Reset image size &amp; position</p>
                <p><strong>Scroll</strong> to zoom in/out</p>
                <p>(When zoomed in, <strong>drag</strong> to pan;<br><strong>double-click</strong> to reset size &amp; position)</p>
            </div>
            <div class="image-number"></div>
            <div class="slideshow-buttons">
                <button type="button" class="slideshow-button previous" tabindex="0" title="Previous image">
                    ${d.svg("chevron-left-solid")}
                </button>
                <button type="button" class="slideshow-button next" tabindex="0" title="Next image">
                    ${d.svg("chevron-right-solid")}
                </button>
            </div>
            <div class="caption"></div>
            <div class="loading-spinner">
                ${d.svg("circle-notch-light")}
            </div>
        </div>`),C(d.mediaQueries.portraitOrientation,{ifMatchesOrAlwaysDo:()=>{requestAnimationFrame(e.resetFocusedImagePosition)},callWhenAdd:!0}),e.overlay.querySelectorAll(".slideshow-button").forEach(a=>{a.addActivateEvent(n=>{c("ImageFocus.slideshowButtonClicked","image-focus.js",2),e.focusNextImage(n.target.classList.contains("next")),e.cancelImageFocusHideUITimer(),n.target.blur()})}),e.overlay.querySelector(".close-button").addActivateEvent(a=>{c("ImageFocus.closeButtonClicked","image-focus.js",2),a.stopPropagation(),e.exitImageFocus()}),e.overlay.addEventListener("click",a=>{a.target===e.overlay&&(c("ImageFocus.overlayBackgroundClicked","image-focus.js",2),e.exitImageFocus())});let o=e.overlay.querySelector(".help-overlay");d.isMobile()?o.addEventListener("click",()=>{o.classList.toggle("open")}):(o.addEventListener("mouseenter",()=>{o.classList.add("open")}),o.addEventListener("mouseleave",()=>{o.classList.remove("open")})),e.hideImageFocusUI();let s=(a,n)=>a.split(", ").map(r=>r+n).join(", ");e.focusableImagesSelector=s(e.contentImagesSelector,".focusable"),e.focusedImageSelector=s(e.contentImagesSelector,".focused"),e.galleryImagesSelector=s(e.contentImagesSelector,".gallery-image"),e.processImagesWithin(document),e.updateGalleryMetadata(),window.addEventListener("hashchange",e.focusImageSpecifiedByURL),d.notificationCenter.fireEvent("ImageFocus.setupDidComplete")},updateGalleryMetadata:()=>{let t=document.querySelectorAll(e.galleryImagesSelector),o=e.overlay.querySelector(".image-number");o.dataset.numberOfImages=t.length,t.length>0&&(t.forEach(s=>s.removeAttribute("accesskey")),t[0].accessKey="l")},designateSmallImageIfNeeded:t=>{let o=parseInt(t.getAttribute("width"),10),s=parseInt(t.getAttribute("height"),10);Number.isFinite(o)&&Number.isFinite(s)&&(o<e.hoverCaptionWidth||s<e.hoverCaptionHeight)&&t.classList.add("small-image")},processImagesWithin:t=>{c("ImageFocus.processImagesWithin","image-focus.js",1),t.querySelectorAll(e.contentImagesSelector).forEach(o=>{o.closest(e.excludedContainerElementsSelector)||(o.classList.add("focusable"),e.imageGalleryInclusionTest(o)&&o.classList.add("gallery-image"),e.designateSmallImageIfNeeded(o))}),t.querySelectorAll(e.focusableImagesSelector).forEach(o=>{o.addEventListener("click",e.imageClickedToFocus)}),t.querySelectorAll(e.focusableImagesSelector).forEach(o=>{o.removeAnnotationLoadEvents=M(o,"mouseenter",e.fullSizeImageLoadHoverDelay,()=>{e.preloadImage(o),o.removeAnnotationLoadEvents()},{cancelOnEvents:["mouseleave"]})}),t.querySelectorAll(e.focusableImagesSelector).forEach(o=>{A(o,"span.image-wrapper.focusable",{moveClasses:["small-image"],useExistingWrapper:!0})})},focusedImgSrcForImage:t=>{let o=h(t.src);if(o.hostname==="upload.wikimedia.org"&&o.pathname.includes("/thumb/")){let s=/(.+)thumb\/(.+)\/[^/]+$/.exec(o.pathname);return s&&(o.pathname=s[1]+s[2]),o.href}if(t.srcset){let s=Array.from(t.srcset.matchAll(/(\S+?)\s+(\S+?)(,|$)/g)),a=s[s.length-1];if(a)return a[1]}return t.dataset.srcSizeFull?t.dataset.srcSizeFull:t.src},expectedDimensionsForImage:t=>{var a,n,r,i;let o=parseInt((n=(a=t.getAttribute("data-image-width"))!=null?a:t.getAttribute("data-file-width"))!=null?n:t.getAttribute("width"),10),s=parseInt((i=(r=t.getAttribute("data-image-height"))!=null?r:t.getAttribute("data-file-height"))!=null?i:t.getAttribute("height"),10);return Number.isFinite(o)&&Number.isFinite(s)?{width:o,height:s}:null},preloadImage:t=>{U({location:e.focusedImgSrcForImage(t)})},focusImage:(t,o=!0)=>{if(c("ImageFocus.focusImage","image-focus.js",1),e.enterImageFocus(),e.unhideImageFocusUI(),e.unfocusImage(),t.classList.toggle("focused",!0),t.classList.contains("gallery-image")){let n=document.querySelector("img.last-focused");n&&(n.classList.remove("last-focused"),n.removeAttribute("accesskey"));let r=document.querySelectorAll(e.galleryImagesSelector),i=e.getIndexOfFocusedImage();e.overlay.querySelector(".slideshow-button.previous").disabled=i===0,e.overlay.querySelector(".slideshow-button.next").disabled=i===r.length-1,e.overlay.querySelector(".image-number").textContent=i+1,location.hash.startsWith("#if_slide_")||(e.savedHash=location.hash),w("#if_slide_"+(i+1)),i>0&&e.preloadImage(r[i-1]),i<r.length-1&&e.preloadImage(r[i+1])}e.currentlyFocusedImage=t,o&&H(e.currentlyFocusedImage);let s=e.focusedImgSrcForImage(t);h(s).pathname.endsWith(".pdf")?(e.imageInFocus=F("iframe",{src:s,class:"image-in-focus",loading:"eager"}),e.imageInFocus.setAttribute("frameborder","0"),e.imageInFocus.style.backgroundColor="#ffffff",e.imageInFocus.style.border="none"):(e.imageInFocus=F("img",{src:s,loading:"eager",decoding:"sync",style:`filter: ${t.style.filter||"none"} ${e.dropShadowFilterForImages}`},{}),t.dataset.aspectRatio&&(e.imageInFocus.dataset.aspectRatio=t.dataset.aspectRatio)),e.imageInFocus.classList.add("image-in-focus"),e.overlay.insertBefore(e.imageInFocus,e.overlay.querySelector(".loading-spinner")),e.resetFocusedImagePosition(!0),e.imageInFocus.addEventListener("mousedown",e.imageMouseDown),e.imageInFocus.addEventListener("dblclick",e.doubleClick),e.overlay.classList.toggle("slideshow",t.classList.contains("gallery-image")),e.setImageFocusCaption(),d.notificationCenter.fireEvent("ImageFocus.imageDidFocus",{image:t})},resetFocusedImagePosition:(t=!1)=>{var I,E;if(c("ImageFocus.resetFocusedImagePosition","image-focus.js",2),e.imageInFocus==null)return;let o=e.imageInFocus.tagName==="IMG",s=0,a=0;if(o&&h(e.imageInFocus.src).pathname.endsWith(".svg"))if(e.imageInFocus.dataset.aspectRatio){e.imageInFocus.style.aspectRatio=e.imageInFocus.dataset.aspectRatio;let g=e.imageInFocus.dataset.aspectRatio.match(/([0-9]+)\s*\/\s*([0-9]+)/);if(g){let W=parseInt(g[1],10)/parseInt(g[2],10);s=window.innerHeight*W,a=window.innerHeight}}else s=a=Math.min(window.innerWidth,window.innerHeight);else if(o){if(t&&(e.imageInFocus.classList.add("loading"),e.imageInFocus.addEventListener("load",()=>{e.imageInFocus.classList.remove("loading"),e.resetFocusedImagePosition()},{once:!0})),s=(I=e.imageInFocus.naturalWidth)!=null?I:0,a=(E=e.imageInFocus.naturalHeight)!=null?E:0,s*a===0){let g=e.expectedDimensionsForImage(e.currentlyFocusedImage);g&&(s=g.width,a=g.height)}}else s=Math.min(window.innerWidth*e.shrinkRatio,window.innerWidth*.9),a=Math.min(window.innerHeight*e.shrinkRatio,window.innerHeight*.9);if(s*a===0)return;let r=Math.min(s,window.innerWidth*e.shrinkRatio)/s,l=Math.min(a,window.innerHeight*e.shrinkRatio)/a,u=Math.min(r,l),m=Math.round(s*u),f=Math.round(a*u);e.imageInFocus.style.width=`${m}px`,e.imageInFocus.style.height=`${f}px`,e.imageInFocus.style.aspectRatio=o?`${m} / ${f}`:"",e.imageInFocus.style.left="",e.imageInFocus.style.top="",e.setFocusedImageCursor()},setFocusedImageCursor:()=>{c("ImageFocus.setFocusedImageCursor","image-focus.js",2),e.imageInFocus!=null&&(e.imageInFocus.style.cursor=e.imageInFocus.height>=window.innerHeight||e.imageInFocus.width>=window.innerWidth?"move":"")},unfocusImage:()=>{if(c("ImageFocus.unfocusImage","image-focus.js",1),e.imageInFocus&&(e.imageInFocus.remove(),e.imageInFocus=null),e.currentlyFocusedImage){let t=e.currentlyFocusedImage;e.currentlyFocusedImage.classList.remove("focused"),e.currentlyFocusedImage=null,d.notificationCenter.fireEvent("ImageFocus.imageDidUnfocus",{image:t})}},enterImageFocus:()=>{c("ImageFocus.enterImageFocus","image-focus.js",1),!e.overlay.classList.contains("engaged")&&(e.overlay.classList.add("engaged"),window.addEventListener("wheel",e.scrollEvent,{passive:!1}),document.addEventListener("keyup",e.keyUp),requestAnimationFrame(()=>{y(!1)}),d.isMobile()===!1&&b(e.mouseMoved,{name:"ImageFocusMousemoveListener"}),window.addEventListener("mouseup",e.mouseUp),d.notificationCenter.fireEvent("ImageFocus.imageOverlayDidAppear"))},exitImageFocus:()=>{var t;if(c("ImageFocus.exitImageFocus","image-focus.js",1),e.currentlyFocusedImage&&e.currentlyFocusedImage.classList.contains("gallery-image")&&(e.currentlyFocusedImage.classList.remove("focused"),e.currentlyFocusedImage.classList.add("last-focused"),e.currentlyFocusedImage.accessKey="l",location.hash.startsWith("#if_slide_"))){let o=h(location.href);o.hash=(t=e.savedHash)!=null?t:"",w(o.href),e.savedHash=null}e.unfocusImage(),document.removeEventListener("keyup",e.keyUp),window.removeEventListener("wheel",e.scrollEvent),window.removeEventListener("mouseup",e.mouseUp),d.isMobile()===!1&&v("ImageFocusMousemoveListener"),e.overlay.classList.remove("engaged"),requestAnimationFrame(()=>{y(!0)}),d.notificationCenter.fireEvent("ImageFocus.imageOverlayDidDisappear")},getIndexOfFocusedImage:()=>{let t=document.querySelectorAll(e.galleryImagesSelector),o=-1;for(let s=0;s<t.length;s+=1)if(t[s].classList.contains("focused")){o=s;break}return o},focusNextImage:(t=!0)=>{c("ImageFocus.focusNextImage","image-focus.js",1);let o=document.querySelectorAll(e.galleryImagesSelector);if(o.length===0)return;let s=e.getIndexOfFocusedImage();s===-1?s=0:s+=t?1:-1,s=Math.max(0,Math.min(o.length-1,s)),o[s]&&e.focusImage(o[s])},setImageFocusCaption:()=>{c("ImageFocus.setImageFocusCaption","image-focus.js",2);let t=e.overlay.querySelector(".caption");if(t.replaceChildren(),!e.currentlyFocusedImage)return;let o=document.createElement("div");o.className="caption-text-wrapper";let s=e.currentlyFocusedImage.closest("figure"),a=s?s.querySelector("figcaption"):null,n=e.currentlyFocusedImage.getAttribute("title"),r=(i,{allowHTML:l=!1}={})=>{if(!i)return;let u=document.createElement("p");l?u.innerHTML=i:u.textContent=i,o.appendChild(u)};if(a&&r(a.innerHTML,{allowHTML:!0}),r(n),o.children.length>0&&t.appendChild(o),!e.imageInFocus.src.startsWith("data:")){let i=document.createElement("p");i.className="image-url",i.setAttribute("title","Click to copy image URL to clipboard");let l=document.createElement("code");l.className="url",l.textContent=e.truncatedURLString(e.imageInFocus.src),i.appendChild(l);let u=document.createElement("span");u.className="icon-container";let m=document.createElement("span");m.className="icon normal",m.innerHTML=d.svg("copy-regular"),u.appendChild(m);let f=document.createElement("span");f.className="icon copied",f.innerHTML=d.svg("circle-check-solid"),u.appendChild(f),i.appendChild(u),t.appendChild(i),i.addActivateEvent(I=>{I.preventDefault(),D(e.currentlyFocusedImage.src).finally(()=>{i.classList.add("copied","flash"),setTimeout(()=>{i.classList.remove("flash")},150)})}),i.addEventListener("mouseleave",()=>{i.classList.remove("copied")})}},truncatedURLString:t=>t.length>160?`${t.slice(0,160)}\u2026`:t,focusImageSpecifiedByURL:()=>{c("ImageFocus.focusImageSpecifiedByURL","image-focus.js",1),location.hash.startsWith("#if_slide_")&&R(()=>{let t=document.querySelectorAll(e.galleryImagesSelector),o=/#if_slide_([0-9]+)/.exec(location.hash),s=o?parseInt(o[1],10):NaN;Number.isFinite(s)&&s>0&&s<=t.length&&e.focusImage(t[s-1])})},hideImageFocusUI:()=>{c("ImageFocus.hideImageFocusUI","image-focus.js",3),e.overlay.querySelectorAll(e.imageFocusUIElementsSelector).forEach(t=>t.classList.toggle("hidden",!0))},hideUITimerExpired:()=>{c("ImageFocus.hideUITimerExpired","image-focus.js",3);let t=Date.now()-e.mouseLastMovedAt;t<e.hideUITimerDuration?e.hideUITimer=setTimeout(e.hideUITimerExpired,e.hideUITimerDuration-t):(e.hideImageFocusUI(),e.cancelImageFocusHideUITimer())},unhideImageFocusUI:()=>{c("ImageFocus.unhideImageFocusUI","image-focus.js",3),e.overlay.querySelectorAll(e.imageFocusUIElementsSelector).forEach(t=>t.classList.toggle("hidden",!1)),e.hideUITimer=setTimeout(e.hideUITimerExpired,e.hideUITimerDuration)},cancelImageFocusHideUITimer:()=>{c("ImageFocus.cancelImageFocusHideUITimer","image-focus.js",3),clearTimeout(e.hideUITimer),e.hideUITimer=null},imageClickedToFocus:t=>{c("ImageFocus.imageClickedToFocus","image-focus.js",2),e.focusImage(t.currentTarget,!1)},scrollEvent:t=>{c("ImageFocus.scrollEvent","image-focus.js",3),t.preventDefault();let o=e.imageInFocus;o.savedFilter=o.style.filter,o.style.filter="none";let s=o.getBoundingClientRect(),a=o.height>10&&o.width>10||t.deltaY<0?1+Math.sqrt(Math.abs(t.deltaY))/100:1;o.style.width=(t.deltaY<0?o.clientWidth*a:o.clientWidth/a)+"px",o.style.height="auto";let r=(o.getBoundingClientRect().width>window.innerWidth||o.getBoundingClientRect().height>window.innerHeight)&&s.left<=t.clientX&&t.clientX<=s.right&&s.top<=t.clientY&&t.clientY<=s.bottom,i;r?i={clientX:t.clientX,clientY:t.clientY}:i=t.deltaY>0?{clientX:window.innerWidth/2,clientY:window.innerHeight/2}:{clientX:s.left+s.width/2,clientY:s.top+s.height/2};let l=i.clientX-s.left,u=i.clientY-s.top;o.style.left=i.clientX-l*o.clientWidth/s.width+"px",o.style.top=i.clientY-u*o.clientHeight/s.height+"px",requestAnimationFrame(()=>e.setFocusedImageCursor())},mouseUp:()=>{if(c("ImageFocus.mouseUp","image-focus.js",2),e.imageInFocus==null)return;let t=e._dragStartMouseX!==0||e._dragStartMouseY!==0;window.removeEventListener("mousemove",e.dragImageMouseMoveHandler),e._dragStartMouseX=0,e._dragStartMouseY=0,e._dragStartImageX=0,e._dragStartImageY=0,t&&(e.imageInFocus.style.filter=e.imageInFocus.savedFilter,e.setFocusedImageCursor()),e.hideUITimer==null&&e.unhideImageFocusUI(),e.overlay.querySelector(".caption").classList.remove("locked"),e.imageInFocus.height<window.innerHeight&&e.imageInFocus.width<window.innerWidth&&(e.imageInFocus.style.left="",e.imageInFocus.style.top="")},imageMouseDown:t=>{if(c("ImageFocus.imageMouseDown","image-focus.js",2),t.button===0&&(t.preventDefault(),e.imageInFocus.height>=window.innerHeight||e.imageInFocus.width>=window.innerWidth)){e._dragStartMouseX=t.clientX,e._dragStartMouseY=t.clientY;let o=getComputedStyle(e.imageInFocus);e._dragStartImageX=parseInt(o.left,10)||0,e._dragStartImageY=parseInt(o.top,10)||0,e.imageInFocus.savedFilter=e.imageInFocus.style.filter,window.addEventListener("mousemove",e.dragImageMouseMoveHandler)}},doubleClick:()=>{c("ImageFocus.doubleClick","image-focus.js",2),(e.imageInFocus.height>=window.innerHeight||e.imageInFocus.width>=window.innerWidth)&&e.resetFocusedImagePosition()},keyUp:t=>{if(c("ImageFocus.keyUp","image-focus.js",3),!(![" ","Spacebar","Escape","Esc","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Up","Down","Left","Right"].includes(t.key)||getComputedStyle(e.overlay).display==="none"))switch(t.preventDefault(),t.key){case"Escape":case"Esc":e.exitImageFocus();break;case" ":case"Spacebar":e.resetFocusedImagePosition();break;case"ArrowDown":case"Down":case"ArrowRight":case"Right":e.currentlyFocusedImage&&e.currentlyFocusedImage.classList.contains("gallery-image")&&e.focusNextImage(!0);break;case"ArrowUp":case"Up":case"ArrowLeft":case"Left":e.currentlyFocusedImage&&e.currentlyFocusedImage.classList.contains("gallery-image")&&e.focusNextImage(!1);break;default:break}},mouseMoved:t=>{c("ImageFocus.mouseMoved","image-focus.js",3);let o=Date.now();[e.imageInFocus,e.overlay,document.documentElement].includes(t.target)?(e.hideUITimer==null&&e.unhideImageFocusUI(),e.mouseLastMovedAt=o):e.cancelImageFocusHideUITimer()}};window.ImageFocus=e,document.addEventListener("DOMContentLoaded",()=>{e.setup(),e.focusImageSpecifiedByURL(),d.notificationCenter.fireEvent("ImageFocus.didLoad")})})();})();
