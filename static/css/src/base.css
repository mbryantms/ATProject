@charset "UTF-8";
@import './colors.css';
@import './fonts.css';
@import './link-icons.css';
@import './fullwidth.css';
@import './toc.css';

:root {
  --AT-serif-font-stack:
    'Source Serif 4', 'Apple Garamond', 'Baskerville', 'Libre Baskerville',
    'Droid Serif', 'Times New Roman', 'Times', serif, 'Noto Emoji', 'Quivira';
  --AT-sans-serif-font-stack:
    'Source Sans 3', 'Lucida Sans Unicode', 'Helvetica', 'Trebuchet MS', sans-serif,
    'Noto Emoji', 'Quivira';
  --AT-monospaced-font-stack:
    'IBM Plex Mono', 'Liberation Mono', 'Consolas', 'Courier', monospace, 'Noto Emoji',
    'Quivira';

  --AT-body-text-font-size: 20px;

  --AT-body-max-width: 935px;
  --AT-body-side-padding: 20px;

  --AT-sidenotes-max-width: 550px;

  --bsm: 2em;

  --AT-image-single-black-star-svg: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 10"><path d="M 5,0 C 4,4 4,4 0,5 4,6 4,6 5,10 6,6 6,6 10,5 6,4 6,4 5,0 Z" /></svg>');
  --AT-image-single-white-star-on-black-circle-svg: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 10"><path d="M 5 0 C 6 4 6 4 10 5 A 5 5 0 0 0 5 0 z M 5 0 A 5 5 0 0 0 0 5 C 4 4 4 4 5 0 z M 0 5 A 5 5 0 0 0 5 10 C 4 6 4 6 0 5 z M 5 10 A 5 5 0 0 0 10 5 C 6 6 6 6 5 10 z"/></svg>');
  --AT-image-single-white-star-rotated-svg: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 10"><path d="M 1.25 1.25 C 3.5 5 3.5 5 1.25 8.75 C 5 6.5 5 6.5 8.75 8.75 C 6.5 5 6.5 5 8.75 1.25 C 5 3.5 5 3.5 1.25 1.25 z M 3 3 C 5 4.2 5 4.2 7 3 C 5.8 5 5.8 5 7 7 C 5 5.8 5 5.8 3 7 C 4.2 5 4.2 5 3 3 z"/></svg>');
  --AT-image-single-white-star-svg: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 10"><path d="M 5 0 C 4 4 4 4 0 5 C 4 6 4 6 5 10 C 6 6 6 6 10 5 C 6 4 6 4 5 0 z M 5 2.5 C 5.5 4.5 5.5 4.5 7.5 5 C 5.5 5.5 5.5 5.5 5 7.5 C 4.5 5.5 4.5 5.5 2.5 5 C 4.5 4.5 4.5 4.5 5 2.5 z"/></svg>');
  --AT-image-checkerboard-000-fff-2x-gif: url('data:image/gif;base64,R0lGODlhBAAEAPAAMQAAAP///ywAAAAABAAEAAACBgQShqgJBQA7');
  --AT-image-checkerboard-777-fff-2x-gif: url('data:image/gif;base64,R0lGODlhBAAEAPAAMXd3d////ywAAAAABAAEAAACBgQShqgJBQA7');
  --AT-image-checkerboard-888-000-2x-gif: url('data:image/gif;base64,R0lGODlhBAAEAPAAMQAAAIiIiCwAAAAABAAEAAACBkwAhqgZBQA7');
  --AT-image-checkerboard-bfbfbf-000-2x-gif: url('data:image/gif;base64,R0lGODlhBAAEAPAAMQAAAL+/vywAAAAABAAEAAACBkwAhqgZBQA7');
  --AT-image-pattern-dotted-161616-on-252525-2x-gif: url('data:image/gif;base64,R0lGODlhEAAQAPAAMRYWFiUlJSwAAAAAEAAQAAACHowPcKgb6V6LtFoDXV6b3Q9aHTZ5WhmmJodK0ajGBQA7');
  --AT-image-pattern-dotted-161616-on-3e3e3e-2x-gif: url('data:image/gif;base64,R0lGODlhEAAQAPAAMRYWFj4+PiwAAAAAEAAQAAACHowPcKgb6V6LtFoDXV6b3Q9aHTZ5WhmmJodK0ajGBQA7');
  --AT-image-pattern-dotted-e6e6e6-on-fff-2x-gif: url('data:image/gif;base64,R0lGODlhEAAQAPAAMebm5v///ywAAAAAEAAQAAACHowPcKgb6V6LtFoDXV6b3Q9aHTZ5WhmmJodK0ajGBQA7');
  --AT-image-pattern-dotted-fff-on-e6e6e6-2x-gif: url('data:image/gif;base64,R0lGODlhEAAQAPAAMebm5v///ywAAAAAEAAQAAACHoQfcagL6V6LtFoDXV6b3Q9aHTZ5WhmmJodK0ajGBQA7');
  --AT-image-asterism-triplewhitestar-svg: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22.35 20"><use href="%23A" x="0" y="10" /><use href="%23A" x="12.5" y="10" /><use href="%23A" x="6.25" y="0" /><defs><path id="A" d="M 5 0 C 4 4 4 4 0 5 C 4 6 4 6 5 10 C 6 6 6 6 10 5 C 6 4 6 4 5 0 z M 5 2.5 C 5.5 4.5 5.5 4.5 7.5 5 C 5.5 5.5 5.5 5.5 5 7.5 C 4.5 5.5 4.5 5.5 2.5 5 C 4.5 4.5 4.5 4.5 5 2.5 z"/></defs></svg>');
  --AT-image-japanesecrest-tsukinihoshi-dottedmoon-svg: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 23 23"><path d="M3.028 3.725c-4.147 4.512-4.034 11.533.34 15.907 4.49 4.49 11.773 4.49 16.264 0s4.49-11.773 0-16.264C15.257-1.007 8.237-1.12 3.725 3.028c3.762-3.4 9.57-3.286 13.197.34 3.743 3.743 3.743 9.81 0 13.553s-9.81 3.743-13.553 0c-3.626-3.626-3.74-9.434-.34-13.197z"/><circle transform="matrix(.707107 -.707107 .707107 .707107 1663.446 -524.914)" cx="-1547.404" cy="-798.145" r="2.156"/></svg>');
  --AT-image-sun-verginasun-black-svg: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40.169"><g transform="matrix(.169492 0 0 .170209 67.602036 -5.5478)"><use href="%23D" /><use href="%23D" transform="matrix(1 0 0 -1 0 301.18804)" width="1" height="1"/><use href="%23D" transform="rotate(180 -280.852 150.594)" width="1" height="1"/><use href="%23D" transform="matrix(-1 0 0 1 -561.70444 0)" width="1" height="1"/><use href="%23C" /><use href="%23C" transform="matrix(1 0 0 -1 0 301.18804)" width="1" height="1"/><use href="%23C" transform="rotate(180 -280.852 150.594)" width="1" height="1"/><use href="%23C" transform="matrix(-1 0 0 1 -561.70444 0)" width="1" height="1"/><use href="%23B" /><use href="%23B" transform="matrix(1 0 0 -1 0 301.18804)" width="1" height="1"/><use href="%23B" transform="rotate(180 -280.852 150.594)" width="1" height="1"/><use href="%23B" transform="matrix(-1 0 0 1 -561.70444 0)" width="1" height="1"/><use href="%23A" /><use href="%23A" transform="rotate(90 -280.852 150.594)" width="1" height="1"/><use href="%23A" transform="rotate(270 -280.852 150.594)" width="1" height="1"/><use href="%23A" transform="matrix(1 0 0 -1 0 301.18804)" width="1" height="1"/><use href="%23X" /></g><defs><path id="A" d="M-280.663 32.594l-7.484 84.047c-1.13 3.43.305 7.303 3.587 9.105 3.708 2.036 8.382.676 10.422-3.025l.03-.03a7.64 7.64 0 0 0 .526-6.111l-7.082-83.986z"/><path id="B" d="M-364.767 66.797l54.252 64.712c1.63 3.22 5.4 4.95 8.987 3.907a7.67 7.67 0 0 0 5.226-9.494v-.043c-.63-2.126-2.1-3.78-3.958-4.692z"/><path id="C" d="M-325.888 42.686l21.338 66.3.155.525.124.4.062-.03c.5 1.036 1.326 1.935 2.412 2.53 2.78 1.527 6.263.522 7.793-2.253 1.148-2.082.86-4.57-.526-6.327l-31.357-61.145z"/><path id="D" d="M-389.98 105.915l62.9 32.28.022-.065a5.76 5.76 0 0 0 3.499.088c3.048-.883 4.8-4.05 3.914-7.093-.663-2.282-2.63-3.84-4.854-4.103l-65.5-21.105z"/><path id="X" d="M-263.73 160.02a19.545 19.545 0 1 1 .051-.094"/></defs></svg>');

  --AT-checkerboard-scrollbar-background-image: var(
    --AT-image-checkerboard-777-fff-2x-gif
  );
  --AT-checkerboard-scrollbar-hover-background-image: var(
    --AT-image-checkerboard-000-fff-2x-gif
  );
}

@media all and (max-width: 649px) {
  :root {
    --AT-body-text-font-size: 18px;

    --AT-body-side-padding: 16px;
  }
}

/***********/
/* GENERAL */
/***********/

html,
.shadow-body {
  --base-font-size: var(--AT-body-text-font-size);
  --background-color: var(--AT-body-background-color);

  background-color: var(--background-color);
  color: var(--AT-body-text-color);
  font-weight: 400;
  font-family: var(--AT-serif-font-stack);
  font-size: var(--base-font-size);
}

/*  Smooth scrolling for anchor links.
    Only apply when user hasn't indicated a preference for reduced motion.
 */
@media (prefers-reduced-motion: no-preference) {
  html {
    scroll-behavior: smooth;
  }
}

/****************/
/* ADAPTIVENESS */
/****************/

/*  Utility classes: show something only on mobile (`.desktop-not`)
    or only on desktop (`.mobile-not`).
 */
@media all and (max-width: 649px) {
  .mobile-not {
    display: none !important;
  }
}

@media all and (min-width: 650px) {
  .desktop-not {
    display: none !important;
  }
}

/**********/
/* LAYOUT */
/**********/

html,
body {
  margin: 0;
  padding: 0;
}

body {
  overflow-x: hidden;
}

main {
  position: relative;
  box-sizing: border-box;
  min-height: 100vh;
  max-width: var(--AT-body-max-width);
  margin: 0 auto;
  padding: 1rem var(--AT-body-side-padding) 1.25rem var(--AT-body-side-padding);
  display: flex;
  flex-flow: column;
}

@media all and (max-width: 649px) {
  main {
    overflow: hidden;
    padding: 1rem var(--AT-body-side-padding) 4.25rem var(--AT-body-side-padding);
  }
}

/*********************/
/* ARTICLE CONTAINER */
/*********************/

article {
  margin-top: 1.75rem;
  flex: 1 1 auto;
}

div.sans-serif {
  font-family: var(--AT-sans-serif-font-stack);
}

/***************/
/* PAGE HEADER */
/***************/

@media all and (max-width: 649px) {
  header {
    margin: 0 1rem 1.75rem 1rem;
  }
}

@media all and (min-width: 650px) {
  header {
    margin: 0.375rem 2rem 1.75rem 2rem;
  }
}

header h1 {
  margin: 0;
  text-align: center;
  line-height: 1.15;
  text-transform: none;
  font-variant-caps: small-caps;
  font-size: 2.5em;
  font-weight: 600;
  letter-spacing: -1px;
}

@media all and (max-width: 649px) {
  header h1 {
    font-size: 2em;
  }
}

/*  Source Serif 4 has no italic small caps, sadly.
 */
header h1 em {
  font-variant-caps: normal;
}

/***********************/
/* PAGE METADATA BLOCK */
/***********************/

#page-metadata {
  --text-alignment: center;
  --text-hyphenation: none;
  --text-indent: 0em;

  line-height: 1.5;
}

#page-metadata:not(:last-child) {
  margin-bottom: 2.25rem;
}

#page-metadata > * + * {
  margin-top: 0.75em;
}

/*************/
/*  Page tags.
 */
#page-metadata .link-tags {
  font-family: var(--AT-monospaced-font-stack);
  font-style: italic;
}

#page-metadata .link-tags a {
  white-space: nowrap;
  margin-right: 0.05em;
  background-position: 0 calc(100% - 1px);
}

#page-metadata .link-tags a:nth-child(n + 2) {
  margin-left: 0.1em;
}

/********************/
/*  Page description.
 */
/*  Override normal handling of italics: before, we wrapped descriptions in
    `<em>`; however, they compile to HTML which can contain italics of their
    own (eg. book titles). This causes HTML Tidy to warn about nested italics
    (which is valid HTML but *usually* means you’ve made an error - this often
    triggers when I mess up bolding, for example, like on /gpt-3). So we
    removed the wrapper in favor of the above `font-style: italic`. However,
    now the titles don’t unitalicize automatically like they would for nested
    italics! So we force italicized titles back to normal Roman font to match
    the expected typographic convention.
 */
#page-metadata .page-description {
  font-style: italic;
}

#page-metadata .page-description em {
  font-style: normal;
}

/************************/
/*  Page metadata fields.
 */
#page-metadata .page-metadata-fields {
  display: flex;
  flex-flow: row wrap;
  justify-content: center;
  align-items: baseline;
}

#page-metadata .page-metadata-fields > span {
  white-space: nowrap;
}

/*  Interpunct separators for the metadata fields; looks nicer than semicolons
    or slashes.
 */
#page-metadata .page-metadata-fields > span::after {
  content: '\00B7'; /* interpunct MIDDLE DOT (U+00B7) '·'; TODO: replace with BULLET .separator-inline? */
  margin: 0 0.75em;
}

/*  No separator at line end.
 */
#page-metadata .page-metadata-fields .page-importance::after,
#page-metadata .page-metadata-fields > span:last-child::after {
  display: none;
}

/*  Adjust icon spacing.
 */
#page-metadata .page-metadata-fields .progress-indicator-icon {
  margin: 0 0 0 0.25em;
}

/*  Adjust z-order of text elements.
 */
#page-metadata .page-metadata-fields a + span {
  position: relative;
  z-index: 1;
}

/*  Flex order.
 */
/* date, author, status */
#page-metadata .page-metadata-fields .page-author,
#page-metadata .page-metadata-fields .page-date-range,
#page-metadata .page-metadata-fields .page-status {
  order: 1;
}

/* certainty, importance */
#page-metadata .page-metadata-fields .page-confidence,
#page-metadata .page-metadata-fields .page-importance {
  order: 3;
}

/* backlinks, similar, bibliography */
#page-metadata .page-metadata-fields .page-backlinks,
#page-metadata .page-metadata-fields .page-similars,
#page-metadata .page-metadata-fields .page-link-bibliography {
  order: 5;
}

/*  Author.
 */
#page-metadata .page-metadata-fields .page-author {
  white-space: normal;
}

/*  Importance.
 */
#page-metadata .page-metadata-fields .page-importance {
  font-variant-numeric: tabular-nums;
}

/*=------------=*/
/*= Responsive =*/
/*=------------=*/

@media all and (min-width: 650px) {
  #page-metadata {
    font-size: calc((19 / 20) * var(--AT-body-text-font-size));
    line-height: calc(1.5 / (19 / 20));
  }

  /*  Page tags.
   */
  #page-metadata .link-tags {
    font-size: calc((16 / 20) * var(--AT-body-text-font-size));
  }

  /*  Page metadata fields.
   */
  #page-metadata .page-metadata-fields {
    font-size: calc((18 / 20) * var(--AT-body-text-font-size));
  }

  /* line break in one place */
  #page-metadata .page-metadata-fields::after {
    content: '';
    width: 100%;
    height: calc(1em * (4 / 20));
  }

  /* break between certainty/importance and backlinks/similar/bibliography */
  #page-metadata .page-metadata-fields::after {
    order: 4;
  }
}

@media all and (max-width: 649px) {
  #page-metadata {
    font-size: calc((17 / 18) * var(--AT-body-text-font-size));
  }

  /*  Page tags.
   */
  #page-metadata .link-tags {
    font-size: calc((16 / 18) * var(--AT-body-text-font-size));
  }

  /*  Page description.
   */
  #page-metadata .page-description {
    line-height: calc(25 / 17);
  }

  /*  Page metadata fields.
   */
  #page-metadata .page-metadata-fields {
    display: flex;
    flex-flow: row wrap;
    justify-content: center;
    font-size: calc((16 / 18) * var(--AT-body-text-font-size));
    line-height: calc(25 / 16);
  }

  /* line breaks in two places */
  #page-metadata .page-metadata-fields::before,
  #page-metadata .page-metadata-fields::after {
    content: '';
    width: 100%;
    height: calc(1em * (3 / 18));
  }

  /* break between date/status and certainty/importance */
  #page-metadata .page-metadata-fields::before {
    order: 2;
  }

  /* break between certainty/importance and backlinks/similar/bibliography */
  #page-metadata .page-metadata-fields::after {
    order: 4;
  }

  /*  No separator at line end.
   */
  #page-metadata .page-metadata-fields .page-author::after,
  #page-metadata .page-metadata-fields .page-status::after {
    display: none;
  }

  /*  Author (on its own line).
   */
  #page-metadata .page-metadata-fields .page-author {
    flex: 1 1 100%;
    text-align: center;
  }

  #page-metadata .page-metadata-fields .page-author::after {
    content: '';
    display: block;
    height: calc(1em * (3 / 18));
  }
}

/**********************/
/* TAG ARCHIVE STYLES */
/**********************/

/*  Breadcrumb separator in tag hierarchy.
 */
#page-metadata .link-tags .breadcrumb-separator {
  color: var(--AT-body-text-secondary-color, #666);
  margin: 0 0.25em;
  font-style: normal;
}

/*  Current tag in breadcrumb (not a link).
 */
#page-metadata .link-tags .tag-current {
  font-weight: bold;
  font-style: normal;
}

/*  Labels for subtags/related tags sections.
 */
#page-metadata .tag-nav-label {
  font-style: normal;
  color: var(--AT-body-text-secondary-color, #666);
  margin-right: 0.25em;
}

/*  Subtags and related tags lists.
 */
#page-metadata .tag-subtags,
#page-metadata .tag-related {
  font-size: 0.95em;
}

/*  Tag aliases ("Also known as") section.
 */
#page-metadata .tag-aliases {
  font-size: 0.9em;
  color: var(--AT-body-text-secondary-color, #666);
  margin-top: 0.25em;
}

#page-metadata .tag-aliases-label {
  font-style: italic;
}

/******************/
/* ARCHIVE STYLES */
/******************/

.archive-year h2 {
  margin-bottom: 0.5em;
}

.archive-list {
  margin-bottom: 1.5em;
}

.archive-date {
  font-family: var(--AT-monospaced-font-stack);
  font-size: 0.9em;
  color: var(--AT-body-text-secondary-color, #666);
  margin-right: 0.5em;
}

/*******************/
/* TAG LIST STYLES */
/*******************/

/*  Controls for sorting, grouping, and display options.
 */
.tag-list-controls {
  margin-top: 0.75em;
  padding-top: 0.75em;
  border-top: 1px solid var(--AT-body-text-faint-color, #e5e5e5);
  font-size: 0.85em;
  display: flex;
  flex-wrap: wrap;
  gap: 1em;
}

.tag-list-controls .control-group {
  display: inline-flex;
  align-items: center;
  gap: 0.25em;
}

.tag-list-controls .control-label {
  color: var(--AT-body-text-secondary-color, #666);
  margin-right: 0.25em;
}

.tag-list-controls .control-option {
  padding: 0.15em 0.5em;
  border-radius: 3px;
  text-decoration: none;
  color: var(--AT-body-text-secondary-color, #666);
  transition: background-color 0.15s ease;
  /* Override Tufte-style link underline styling */
  text-shadow: none;
  background-image: none;
}

.tag-list-controls .control-option:hover {
  background-color: var(--AT-body-text-faint-color, #f0f0f0);
  color: var(--AT-body-text-primary-color, #333);
}

.tag-list-controls .control-option.active {
  background-color: var(--AT-body-text-secondary-color, #666);
  color: var(--AT-body-background-color, #fff);
}

/*  Tag list section headers (when grouped).
 */
.tag-list-section h2 {
  margin-top: 1.5em;
  margin-bottom: 0.5em;
}

.tag-list-section:first-of-type h2 {
  margin-top: 0;
}

/*  Tag list items.
 */
.tag-list {
  margin-bottom: 1.5em;
}

.tag-list-item {
  margin-bottom: 0.25em;
}

.tag-list-item-expanded {
  margin-bottom: 0.75em;
}

.tag-list-main {
  display: flex;
  align-items: center;
  flex-wrap: wrap;
  gap: 0.25em;
}

.tag-list-main .tag-name {
  font-weight: 500;
}

.tag-list-main .tag-count {
  color: var(--AT-body-text-secondary-color, #666);
  font-size: 0.9em;
}

.tag-list-main .tag-namespace {
  color: var(--AT-body-text-secondary-color, #666);
  font-size: 0.85em;
}

.tag-list-main .tag-parent {
  color: var(--AT-body-text-secondary-color, #666);
  font-size: 0.85em;
  margin-left: 0.5em;
}

.tag-list-main .tag-parent a {
  color: var(--AT-body-text-secondary-color, #666);
}

/*  Color indicator dot.
 */
.tag-color-dot {
  display: inline-block;
  width: 0.65em;
  height: 0.65em;
  border-radius: 50%;
  flex-shrink: 0;
}

/*  Icon display.
 */
.tag-icon {
  font-size: 1em;
  margin-right: 0.1em;
}

/*  Tag description (optional).
 */
.tag-description {
  font-size: 0.85em;
  color: var(--AT-body-text-secondary-color, #666);
  margin-top: 0.15em;
  margin-left: 1em;
  line-height: 1.4;
}

/****************/
/* MAIN CONTENT */
/****************/

#markdownBody {
  position: relative;
}

.markdownBody {
  --base-block-spacing: 0.25em;

  /*  Try to avoid scrollbars on paragraphs: prevents long unbroken
      un-hyphenatable lines from causing H-scrolling.
   */
  overflow-wrap: break-word;

  /*  Cute ‘old-style’ numerals, look a little nicer inline in text, and
      available natively in the SS font:

      https://practicaltypography.com/alternate-figures.html#oldstyle-figures
   */
  font-variant-numeric: oldstyle-nums;

  line-height: var(--line-height);
}

/*  Replaces A/B-test-set average value; the wider the screen, the more
    line-height is necessary, and no one size suits all, so set 4 brackets
    of increasing height.
 */
@media all and (max-width: 649px) {
  .markdownBody {
    --line-height: 1.45;
  }
}

@media all and (max-width: 999px) {
  .markdownBody {
    --line-height: 1.5;
  }
}

@media all and (max-width: 1199px) {
  .markdownBody {
    --line-height: 1.55;
  }
}

@media all and (min-width: 1200px) {
  .markdownBody {
    --line-height: 1.6;
  }
}

/*  `bsm` = “block spacing multiplier”
 */
.markdownBody .block {
  margin-top: 24px;
}

/************/
/*  Headings.
 */

.heading {
  display: flow-root;
  margin: 0;
  position: relative;
  line-height: 1;
}

@media all and (min-width: 1180px) {
  .heading {
    margin-left: calc(-1 * var(--base-font-size));
  }
}

/*  H1.
 */

section.level1 > .heading {
  text-align: right;
  font-weight: 600;
  font-variant-caps: small-caps;
  letter-spacing: -0.75px;
  padding: 0 0.05em 0.025em calc(1.25 * var(--base-font-size));
  border-bottom: 1px solid var(--AT-H1-border-color);
}

@media all and (max-width: 1179px) {
  section.level1 > .heading {
    font-size: 1.75em;
  }
}

@media all and (min-width: 1180px) {
  section.level1 > .heading {
    font-size: 2em;
  }
}

section.level1 > .heading em {
  font-variant-caps: normal;
}

section.level1 > .heading em:last-child {
  padding-right: 0.075em;
}

/*  H2.
 */
section.level2 > .heading {
  text-transform: uppercase;
  font-size: 1.4em;
  padding: 0 calc(0.75 * var(--base-font-size)) 0.05em 0;
  border-bottom: 1px dotted var(--AT-H2-border-color);
}

/*  H3.
 */
section.level3 > .heading {
  font-size: 1.35em;
  font-weight: bold;
}

/*  H4.
 */
section.level4 > .heading {
  font-size: 1.2em;
}

/*  H5.
 */
section.level5 > .heading {
  font-size: 1.1em;
}

/*  H6.
 */
section.level6 > .heading {
  font-size: 1.1em;
  font-weight: normal;
  font-style: italic;
}

/*=---------------------------=*/
/*= Misc. styling in headings =*/
/*=---------------------------=*/

/*  No link underlining in headings.
 */
.markdownBody .heading a {
  background: none;
}

/*  No visited link styling in headings.
 */
.markdownBody .heading a:link,
.markdownBody .heading a:visited {
  color: var(--AT-body-link-color);
}

.markdownBody .heading a:hover,
.markdownBody .heading a:visited:hover {
  color: var(--AT-body-link-hover-color);
}

/*=----------------------------=*/
/*= Section heading self-links =*/
/*=----------------------------=*/

.heading a::after {
  content: '\00B6'; /* Pilcrow sign: ¶ */
  font-size: 0.75em;
  position: absolute;
  bottom: 0.15em;
  right: 0;
  visibility: hidden;
  opacity: 0;
  transition: opacity 0s ease 0.1s;
}

.heading a:hover::after,
section.highlighted > .heading a::after,
section:target > .heading a::after {
  visibility: visible;
}

.heading a:hover::after,
section.highlighted > .heading a::after {
  opacity: 0.8;
}

section:target > .heading a::after {
  opacity: 0.5;
}

/*  Pilcrow in H1.
 */
section.level1 > .heading a::after {
  right: unset;
  left: 0;
}

/*  Pilcrow in H3, H4, H5, H6.
 */
section.level3 > .heading a,
section.level4 > .heading a,
section.level5 > .heading a,
section.level6 > .heading a {
  position: relative;
}

section.level3 > .heading a::after,
section.level4 > .heading a::after,
section.level5 > .heading a::after,
section.level6 > .heading a::after {
  right: -2.75em;
}

section.level3 > .heading a::after,
section.level4 > .heading a::after {
  bottom: 0.4em;
}

section.level5 > .heading a::after,
section.level6 > .heading a::after {
  bottom: 0.3em;
}

/*=-----------------------------------=*/
/*= Section heading copy link buttons =*/
/*=-----------------------------------=*/

.heading .copy-section-link-button {
  display: inline-flex;
  width: 1em;
  height: 1em;
  color: var(--AT-body-link-color);
  transform: rotateZ(-45deg);
  opacity: 0;
}

@media all and (hover: hover) {
  .heading .copy-section-link-button::after {
    content: '';
    position: absolute;
    left: -0.1em;
    right: -0.1em;
    top: -0.1em;
    bottom: -0.1em;
    display: none;
  }

  .heading .copy-section-link-button:hover::after {
    display: initial;
  }
}

.heading .copy-section-link-button:hover {
  color: var(--AT-body-link-hover-color);
}

.heading .copy-section-link-button:hover,
.heading:hover .copy-section-link-button {
  opacity: 1;
}

.heading .copy-section-link-button:active {
  transform: rotateZ(45deg);
  transition: transform 0.05s ease;
}

.heading .copy-section-link-button.clicked {
  transform: rotateZ(135deg);
  transition: transform 0.15s ease;
}

.heading .copy-section-link-button:focus {
  outline: none;
}

@media all and (max-width: 649px) {
  section > .heading .copy-section-link-button {
    position: relative;
    padding: 0.15em;
    margin-left: 0.25em;
    display: none;
  }

  section > .heading:hover .copy-section-link-button {
    display: inline-flex;
  }

  section.level1 > .heading .copy-section-link-button {
    top: 2px;
  }
}

@media all and (min-width: 650px) {
  section.level1 > .heading .copy-section-link-button {
    position: absolute;
    padding: 0.22em;
    right: -1em;
    top: 3px;
  }

  section.level2 > .heading .copy-section-link-button,
  section.level3 > .heading .copy-section-link-button,
  section.level4 > .heading .copy-section-link-button,
  section.level5 > .heading .copy-section-link-button,
  section.level6 > .heading .copy-section-link-button {
    position: relative;
    padding: 0.15em;
    margin-left: 0.25em;
  }

  section.level2 > .heading .copy-section-link-button {
    top: 1px;
  }

  section.level3 > .heading .copy-section-link-button,
  section.level4 > .heading .copy-section-link-button,
  section.level5 > .heading .copy-section-link-button,
  section.level6 > .heading .copy-section-link-button {
    top: 0;
  }
}

button {
  appearance: none;
  border: none;
  background-color: transparent;
  line-height: 1;
  font-family: var(--AT-sans-serif-font-stack);
  font-size: inherit;
  font-weight: normal;
  font-style: normal;
  text-align: center;
  color: inherit;
  display: flex;
  align-items: stretch;
  justify-content: stretch;
  padding: 0;
  margin: 0;
  cursor: pointer;
}

/**************/
/* PARAGRAPHS */
/**************/

p {
  margin: 0;
}

p.empty-graf {
  height: 0 !important;
  margin: 0 !important;
  visibility: hidden;
}

/*  On wide screens (desktop), use fully-justified text (words get
    broken/hyphenated as necessary to avoid a ‘ragged margin’), overriding
    browser default of ‘flush left, ragged right’ (see
    https://en.wikipedia.org/wiki/Typographic_alignment#Flush_left )

    On mobile/narrow screens, that doesn’t work as well: because browsers do
    greedy layout, justification forces ‘s t r e t c h e d out’ words
    and large spaces, leading to blatant
    https://en.wikipedia.org/wiki/River_(typography) , getting worse the
    narrower the screen (eg. in lists). On wide screens, it isn’t too bad, and
    justification is still better than not, but on mobile it is extremely
    noticeable. Switching to flush left ragged right doesn’t look as nicely
    ‘even’, but it avoids that pathological behavior. (More advanced
    typesetting algorithms like Knuth-Plass
    https://en.wikipedia.org/wiki/Line_wrap_and_word_wrap#Minimum_raggedness
    can handle mobile widths nicely, but no contemporary browser implements
    them natively, and all JS implementations I’ve looked at are buggy.)

    However, do hyphenate at all widths.
*/

.markdownBody p {
  -webkit-hyphens: var(--text-hyphenation);
  hyphens: var(--text-hyphenation);
  text-align: var(--text-alignment);
}

.markdownBody p:not(.first-graf) {
  text-indent: var(--text-indent);
}

/*  Prevent inheritance of indentation property.
 */
.markdownBody p * {
  text-indent: 0;
}

/*  Specify indentation, alignment, hyphenation.
 */
.markdownBody {
  --text-indent: 1.75em;
  --text-alignment: justify;
  --text-hyphenation: auto;
}

/*  Justification only matters for the wide.
 */
@media all and (max-width: 649px) {
  .markdownBody {
    --text-alignment: left;
  }
}

/*  Larger indentation in main content column on non-phones.
 */
@media all and (min-width: 650px) {
  #markdownBody {
    --text-indent: 2.5em;
  }
}

/**************/
/*  Exceptions.
 */

/*  EPITAPH (eg /LARPing)
 */
.markdownBody p.text-center {
  text-align: center;
  text-indent: 0;
}

.markdownBody p.text-right {
  text-align: right;
  text-indent: 0;
}

/***************/
/* BLOCKQUOTES */
/***************/

blockquote {
  --blockquote-vertical-padding: 0.9em;
  --blockquote-horizontal-padding: 1.25em;
  --blockquote-font-size-scaling-factor: 0.95;

  display: flow-root;
  margin: 0;
  overflow: visible;
  border: 1px solid var(--border-color);
  background-color: var(--background-color);
  padding: var(--blockquote-vertical-padding) var(--blockquote-horizontal-padding);
}

@media all and (max-width: 649px) {
  blockquote {
    --blockquote-vertical-padding: 0.7em;
    --blockquote-horizontal-padding: 1em;
  }
}

blockquote > * {
  font-size: calc(var(--blockquote-font-size-scaling-factor) * 1em);
  line-height: calc(
    (var(--line-height) - 0.05) / var(--blockquote-font-size-scaling-factor)
  );
}

/*  Three-level of blockquote emphasis (darkening).
 */
blockquote,
.blockquote-level-1,
.blockquote-level-4 {
  --background-color: var(--AT-blockquote-background-color-level-one);
}

.blockquote-level-2,
.blockquote-level-5 {
  --background-color: var(--AT-blockquote-background-color-level-two);
}

.blockquote-level-3,
.blockquote-level-6 {
  --background-color: var(--AT-blockquote-background-color-level-three);
}

/*  Borders must follow a different cycle.
 */
blockquote,
.blockquote-level-1 {
  --border-color: var(--AT-blockquote-border-color-level-one);
}

.blockquote-level-2,
.blockquote-level-5 {
  --border-color: var(--AT-blockquote-border-color-level-two);
}

.blockquote-level-3,
.blockquote-level-6 {
  --border-color: var(--AT-blockquote-border-color-level-three);
}

.blockquote-level-4 {
  --border-color: var(--AT-blockquote-border-color-level-four);
}

/*  Headings in blockquotes.
 */
@media all and (min-width: 1180px) {
  blockquote .heading {
    margin-left: 0;
  }
}

/*********/
/* LISTS */
/*********/

/**************/
/*  Edge cases.
 */

/*  Necessary for list items to wrap around floating elements in list items.

    NOTE: The consequence of this is that any list that contains a floating
    element (e.g. a figure floated left or right) will not display correctly
    if positioned next to the page table of contents. Caveat emptor!
 */
ul.has-floats > li,
ol.has-floats > li {
  display: list-item;
}

/*  List headings are normally paragraphs, but should never be indented.
 */
.markdownBody p.list-heading {
  text-indent: 0;
}

/*.markdownBody .block {*/
/*  margin-top: 0;*/
/*}*/

.list {
  --text-alignment: left;
  --list-left-padding: 2.5em;

  margin: 0;
  padding: 0;
  list-style-type: none;
}

@media all and (max-width: 649px) {
  .list {
    --list-left-padding: 1.75em;
  }
}

@media all and (min-width: 650px) {
  .list.big-list {
    --text-alignment: justify;
  }
}

li {
  position: relative;
  display: flow-root;
  padding: 0 0 0 var(--list-left-padding);
}

/*=-----------------------=*/
/*= Bulleted list markers =*/
/*=-----------------------=*/

ul > li::before {
  --dark-mode-invert-filter: var(--list-bullet-dark-mode-invert-filter);

  content: var(--list-bullet);
  position: absolute;
  z-index: 1;
  display: block;
  left: calc(var(--list-left-padding) - 1.375em);
  top: 0.35em;
  width: 0.75em;
  height: 1em;
  line-height: 1;
  opacity: var(--list-bullet-opacity);
}

ul > li {
  --list-bullet-dark-mode-invert-filter: invert(1);
}

ul,
ul.list-level-1 {
  --list-bullet: var(--AT-image-single-black-star-svg);
  --list-bullet-opacity: 0.65;
}

ul.list-level-2 {
  --list-bullet: var(--AT-image-single-white-star-svg);
  --list-bullet-opacity: 0.85;
}

ul.list-level-3 {
  /*  This rotates into more of a ‘lozenge’ square for variety’s sake.
   */
  --list-bullet: var(--AT-image-single-white-star-rotated-svg);
  --list-bullet-opacity: 0.85;
}

ul.list-level-4 {
  --list-bullet: var(--AT-image-single-black-star-svg);
  --list-bullet-opacity: 0.85;
}

ul.list-level-5 {
  /*  This rotates into more of a ‘lozenge’ square for variety’s sake.
   */
  --list-bullet: var(--AT-image-single-white-star-svg);
  --list-bullet-opacity: 0.85;
}

ul.list-level-6 {
  /*  This rotates into more of a ‘lozenge’ square for variety’s sake.
   */
  --list-bullet: var(--AT-image-single-white-star-rotated-svg);
  --list-bullet-opacity: 0.85;
}

/*=-----------------------=*/
/*= Numbered list markers =*/
/*=-----------------------=*/

/*  This may not be necessary. It definitely causes the `start` HTML list
    property to not work correctly, so if indeed it’s unnecessary otherwise, it
    should be removed. Commenting it out for now until we can confirm that no
    bugs are caused by its absence.
        —SA 2023-07-24
/*
ol {
    counter-reset: list-item;
}
 */

ol > li {
  counter-increment: list-item;
}

ol > li::before {
  position: absolute;
  z-index: 15;
  display: block;
  left: 0;
  top: 0;
  width: calc(var(--list-left-padding) - 0.375em);
  text-align: right;
}

/*  Specific list type overrides. (Used by auto-sequencing, but can also be
    invoked manually from the source.)

    Manual invocation assumes writing plain `<ol>` HTML lists instead of Arabic
    numerals like `<ol type="1">`. Pandoc Markdown defaults to the latter if you
    write '1./2.' etc, but an alternate syntax, '#.' is supported which yields a
    plain `<ol>` which can be more easily styled.
    (See https://pandoc.org/MANUAL.html#extension-startnum .)
*/
ol > li::before,
ol.list-type-decimal > li::before {
  content: counter(list-item, decimal) '.';
}

ol.list-type-lower-alpha > li::before {
  content: counter(list-item, lower-alpha) '.';
}

ol.list-type-upper-alpha > li::before {
  content: counter(list-item, upper-alpha) '.';
}

ol.list-type-lower-roman > li::before {
  content: counter(list-item, lower-roman) '.';
}

ol.list-type-upper-roman > li::before {
  content: counter(list-item, upper-roman) '.';
}

ol.list-type-lower-greek > li::before {
  content: counter(list-item, lower-greek) '.';
}

/**********/
/* FLOATS */
/**********/
/*  Floating figures (mostly for amusing asides/memes), floating small tables,
    code blocks, blockquotes, etc.
 */

@media all and (min-width: 650px) {
  .markdownBody {
    --float-side-margin: 2em;
  }

  .markdownBody blockquote {
    margin-top: 24px;
    --float-side-margin: 1.5em;
  }

  div.float,
  figure.float {
    max-width: calc(50% - var(--float-side-margin));
    margin-bottom: calc(var(--float-side-margin) * 0.5);
    position: relative;
    z-index: 1;
  }

  div.float-right,
  figure.float-right {
    float: right;
    margin-right: 0;
    margin-left: var(--float-side-margin);
  }

  div.float-left,
  figure.float-left {
    float: left;
    margin-left: 0;
    margin-right: var(--float-side-margin);
  }
}

/*********/
/* LINKS */
/*********/

a {
  text-decoration: none;
  color: var(--AT-body-link-color); /* off-black */
}

/*  Slightly gray out links the reader has already visited, so they know if
    they’ve seen that content before. (A critical affordance in densely
    hyperlinked longform.)
 */
.markdownBody a:hover {
  color: var(--AT-body-link-hover-color);
}

.markdownBody a:visited {
  color: var(--AT-body-link-visited-color);
}

.markdownBody a:visited:hover {
  color: var(--AT-body-link-hover-color);
}

/*=------------------------=*/
/*= Fancy link underlining =*/
/*=------------------------=*/

/*  Tufte CSS for underlining (https://github.com/edwardtufte/tufte-css)
    The advantage of all this CSS linenoise compared to the previous 'text-decoration: none; border-bottom: 1px Solid grey;' solution from http://devhints.wordpress.com/2006/10/24/css-links-with-different-color-underlines/
    is the 'skip-ink': when dealing with characters with 'descenders', like 'y', 'g', 'p', 'q' etc, with regular underlining the bottom stroke overlaps with the line and it's harder to read;
    by adding this text-shadow stuff and backgrounding, a little break is made in the underline to add contrast and keep the descender fully visible and outlined. (The downside is that the overlapping text-shadows can also slightly damage the rendering of slashes & parentheses, which come too close and get partially erased.)

    Unfortunately, we don't want to add underlines to links in the TOC because it clutters it (all the lines are links and are in small font), so we have to avoid styling the TOC, which is difficult.
    I got around this by adding in the Hakyll template an additional <div> just for the body of the Markdown content, excluding the TOC, and changing the Tufte CSS to target *that* instead.

May be able at some point to simplify this using regular link underlining, since CSS4's `text-decoration-skip-ink` by default avoids overlapping with text descenders (but as of Oct 2019, no Edge/IE or Safari support, and only the latest Firefox 70 supports it; maybe in a few years...): https://developer.mozilla.org/en-US/docs/Web/CSS/text-decoration-skip-ink#Browser_Compatibility https://www.caniuse.com/#feat=mdn-css_properties_text-decoration-skip-ink (Right now, Firefox skip-ink looks quite bad: it doesn't skip enough ink, defeating the point, and also positions the underline badly!)
*/

/*  Color-inverted containers.
 */
/*.markdownBody .colors-invert a {*/
/*  color: var(--AT-body-link-inverted-color);*/
/*}*/

/*.markdownBody .colors-invert a:hover {*/
/*  color: var(--AT-body-link-inverted-hover-color);*/
/*}*/

/*.markdownBody .colors-invert a:visited {*/
/*  color: var(--AT-body-link-inverted-visited-color);*/
/*}*/

/*.markdownBody .colors-invert a:visited:hover {*/
/*  color: var(--AT-body-link-inverted-hover-color);*/
/*}*/

.markdownBody a {
  --link-underline-background-color: var(--background-color);
  --link-underline-gradient-line-color: currentColor;

  background-image: linear-gradient(
    var(--link-underline-gradient-line-color),
    var(--link-underline-gradient-line-color)
  );
  background-size: 1px 1px;
  background-repeat: repeat-x;
  background-position: 0 calc(100% - 0.1em);

  /*  Disable oldstyle nums in underlined links because the oldstyle nums are almost subscript-like and overlap */
  font-variant-numeric: lining-nums;
}

.markdownBody a,
.markdownBody a * {
  text-shadow:
    0 0.05em var(--link-underline-background-color),
    0.05em 0.05em var(--link-underline-background-color),
    -0.05em 0.05em var(--link-underline-background-color),
    0.17em 0.05em var(--link-underline-background-color),
    -0.17em 0.05em var(--link-underline-background-color),
    0.17em 0 var(--link-underline-background-color),
    -0.17em 0 var(--link-underline-background-color);
}

/*  Links with decoration disabled.
 */
.markdownBody a.decorate-not,
.markdownBody a.decorate-not * {
  background-image: none;
  text-shadow: none;
}

/* eliminate the blurring of headers and links when selecting by overriding the text-shadow: */
::selection {
  text-shadow: none;
  background: var(--AT-text-selection-background-color);
  color: var(--AT-text-selection-color);
}

/*  Prevent code block background color and border from obscuring link
    underlining, for inline <code> elements in links.
 */
a code {
  border-bottom-width: 0;
  word-break: break-all;
  background-color: transparent;
}

/*  Reduce text-shadow overlap partially erasing letters next to smallcaps:
    eg. in `<a href="https://www.microcovid.org/">"microCOVID project"</a>`,
    the ‘o’ in ‘micro’ will be partially erased and look like a ‘c’ without
    some sort of extra spacing.
 */
.markdownBody a .smallcaps {
  margin-left: 0.8px;
}

/*  Like above, but for subscripts and superscripts.
 */
.markdownBody a sub,
.markdownBody a sup {
  padding: 0 0.05em;
}

/*  Prevent text-shadow of italics in links from creating visual glitches
    (also fixes occasional link icon overlaps, eg. a WP link to ‘MGS:V’ where
    the right-tilted ‘V’ would touch the WP ‘W’ link icon).
 */
.markdownBody em {
  margin-right: 0.1em;

  /*  Source Serif 4 has no italic small caps.
   */
  font-variant-caps: normal;
}

/*  Inline SVG icons.
    (These need to be in `initial.css` because some of them are used in the
     opening paragraphs of /index.)
 */
.inline-icon {
  --link-underline-background-color: var(--background-color);

  --icon-opacity: 1;
  --icon-width: 1em;
  --icon-height: 1em;
  --icon-offset-x: 0em;
  --icon-offset-y: 0em;

  position: relative;
  top: calc(0.05em + var(--icon-offset-y));
  left: var(--icon-offset-x);
  background-color: var(--link-underline-background-color);
  padding-left: calc(var(--icon-width) + 0.2em);
}

.inline-icon::before {
  --dark-mode-invert-filter: invert(1);

  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  opacity: var(--icon-opacity);
  background-image: var(--icon-url);
  background-repeat: no-repeat;
  background-position: center;
  background-size: var(--icon-width) var(--icon-height);
}

.icon-moon-solid,
.icon-gear-solid {
  --icon-opacity: 0.7;
  --icon-width: 0.9em;
  --icon-height: 1em;
}

.icon-book-open-solid,
.icon-message-slash-solid,
.icon-eye-slash-solid {
  --icon-opacity: 0.7;
  --icon-width: 0.9em;
  --icon-height: 0.75em;
}

.icon-manicule-left,
.icon-manicule-right {
  --icon-opacity: 0.85;
  --icon-width: 1.7em;
  --icon-height: 1.1em;
  --icon-offset-y: -0.05em;
}

.icon-sun-solid {
  --icon-opacity: 0.75;
  --icon-width: 1em;
  --icon-height: 1em;
}

.icon-magnifying-glass {
  --icon-opacity: 0.9;
  --icon-width: 0.9em;
  --icon-height: 1em;
}

.icon-question-solid {
  --icon-width: 0.55em;
}

.icon-single-white-star-on-black-circle {
  --icon-opacity: 0.75;
  --icon-width: 0.65em;
  --icon-height: 1em;

  /*  This icon uses a special data-URI variable.
   */
  --icon-url: var(--AT-image-single-white-star-on-black-circle-svg);
}

.icon-special.progress-indicator-icon {
  --icon-opacity: 0.6;
  --icon-width: 0.8em;
}

/*  Recently-modified link icons.
    (These need to be in `initial.css` because they are used on /index.)
    NOTE: These also need to be inverted in `dark-mode-adjustments.css` (to avoid invisibility).
 */
.has-recently-modified-icon .recently-modified-icon-hook {
  --link-underline-background-color: var(--background-color);

  --icon-opacity: 0.75;
  --icon-width: 0.65em;
  --icon-height: 1em;

  position: relative;
  top: 0.05em;
  background-color: var(--link-underline-background-color);
  padding-left: calc(var(--icon-width) + 0.2em);
}

.has-recently-modified-icon .recently-modified-icon-hook::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  opacity: var(--icon-opacity);
  background-image: var(--AT-image-single-white-star-on-black-circle-svg);
  background-repeat: no-repeat;
  background-position: center;
  background-size: var(--icon-width) var(--icon-height);
}

.has-recently-modified-icon .recently-modified-icon-hook::before {
  background-position: center left;
}

/********************/
/* SUB/SUPERSCRIPTS */
/********************/

sub,
sup {
  font-size: 0.7em;
  position: relative;
  line-height: 0.3em;
  font-variant-numeric: lining-nums;
}

sub {
  bottom: 0.1em;
}

/*  SUBSCRIPT+SUPERSCRIPT (necessary for inflation adjuster, and other math)
 */
.subsup {
  margin-left: 0.15em;
  margin-right: 0.1em;
  display: inline-flex;
  flex-flow: column;
  align-items: flex-start;
  vertical-align: text-bottom;
  position: relative;
  bottom: -0.1em;
}

.subsup sup,
.subsup sub {
  position: relative;
  line-height: 1;
  font-size: 0.6em;
}

/********/
/* MISC */
/********/

svg {
  fill: currentColor;
}

/*  Date ranges.

    These should also move as a block, just like inflation adjustments. Also,
    the en-dash should be v-positioned as one normally would be, for clarity.
 */
span.date-range {
  white-space: nowrap;
  font-variant-numeric: oldstyle-nums;
}

/* Unless in a link, for the usual reasons: */
a span.date-range {
  font-variant-numeric: tabular-nums;
}

/* Allow specifying it manually (helpful for cases like ISBNs) */
.markdownBody .tabular-nums {
  font-variant-numeric: tabular-nums;
}

span.date-range .subsup {
  align-items: center;
  bottom: 0;
  margin: -0.5em 0.05em 0 0.1em;
}

span.date-range .subsup sup {
  font-size: 1em;
  top: 0.45em;
}

span.date-range .subsup sub {
  bottom: -0.25em;
}

span.date-range > sub {
  margin: 0 0.1em;
  bottom: 0;
}

/*  Hide date range metadata on mobile (just display like normal).
 */
@media all and (max-width: 649px) {
  span.date-range sub {
    display: none;
  }

  span.date-range .subsup {
    margin: 0;
  }

  span.date-range .subsup sup {
    top: -0.15em;
  }
}

/*  Small caps blocks.
 */
p.smallcaps {
  font-variant-caps: small-caps;
}

/*  Auto-smallcaps introductory paragraphs of documents or sub-documents.
    (This is also where dropcaps appear.)
 */
p.intro-graf::first-line {
  font-variant-caps: small-caps;
}

.smallcaps-not > p.intro-graf::first-line {
  font-variant-caps: unset;
}

/*  Enable standard Pandoc attribute-based syntax for small-caps like
    ‘[foo]{.smallcaps}’; see https://pandoc.org/MANUAL.html#small-caps
 */
span.smallcaps {
  font-variant-caps: small-caps;
}

/*********************/
/* SECTION SEPARATOR */
/*********************/

hr {
  border: 0;
  display: flex;
  margin: 0;
}

/*  These classes are created at compile-time by the ‘rulersCycle’ Pandoc
    rewrite pass in Typography.hs; they assign each use of <hr> in the body a
    class 0-2 (n modulo 3). This lets us create an astronomical theme cycle:
    the first, fourth, seventh etc rulers are the triple-white star; the
    second, fifth, eighth etc are a dotted moon; the third, sixth, ninth etc
    are a sun.
 */
hr::after {
  --dark-mode-invert-filter: var(--icon-dark-mode-invert-filter);

  content: '';
  margin: auto;
  box-sizing: border-box;
  width: 40px;
  height: var(--icon-size);
  background-image: var(--icon-image);
  background-repeat: no-repeat;
  background-position: center;
  background-origin: content-box;
  opacity: var(--icon-opacity);
}

hr {
  --icon-size: 40px;
  --icon-opacity: 0.85;
  --icon-dark-mode-invert-filter: invert(1) drop-shadow(0 0 0 currentColor);
}

hr.horizontal-rule-small {
  --icon-size: 15px;
}

hr.horizontal-rule-1 {
  /*  https://commons.wikimedia.org/wiki/File:Sun_of_Vergina_black.svg
      */
  --icon-image: var(--AT-image-sun-verginasun-black-svg);
  --icon-size: 40px;
  --icon-opacity: 0.85;
  --icon-dark-mode-invert-filter: invert(1) drop-shadow(0 0 0 currentColor);
}

hr.horizontal-rule-2 {
  /*  https://commons.wikimedia.org/wiki/File:Japanese_crest_Tsuki_ni_Hoshi.svg

      NOTE: alternative moon icon is
      https://commons.wikimedia.org/wiki/File:Japanese_crest_Oooka_Shippou_of_Oooka_Tadasuke.svg
      - while nice, it lacks the intense moire effect of the Vergina Sun
   */
  --icon-image: var(--AT-image-japanesecrest-tsukinihoshi-dottedmoon-svg);
  --icon-size: 28px;
  --icon-opacity: 0.85;
  --icon-dark-mode-invert-filter: invert(1);
}

hr.horizontal-rule-3 {
  --icon-image: var(--AT-image-asterism-triplewhitestar-svg);
  --icon-size: 38px;
  --icon-opacity: 0.9;
  --icon-dark-mode-invert-filter: invert(1) drop-shadow(0 0 0 currentColor);
}

/********************/
/* SUB/SUPERSCRIPTS */
/********************/

sub,
sup {
  font-size: 0.7em;
  position: relative;
  line-height: 0.3em;
  font-variant-numeric: lining-nums;
}

sub {
  bottom: 0.1em;
}

/*  SUBSCRIPT+SUPERSCRIPT (necessary for inflation adjuster, and other math)
 */
.subsup {
  margin-left: 0.15em;
  margin-right: 0.1em;
  display: inline-flex;
  flex-flow: column;
  align-items: flex-start;
  vertical-align: text-bottom;
  position: relative;
  bottom: -0.1em;
}

.subsup sup,
.subsup sub {
  position: relative;
  line-height: 1;
  font-size: 0.6em;
}

/*************/
/* FOOTNOTES */
/*************/

/*=-----------=*/
/*= Citations =*/
/*=-----------=*/

a.footnote-ref {
  vertical-align: super;
  line-height: 0.3;
  position: relative;
  top: 0.05em;
  padding: 0 0.05em;
  font-variant-numeric: lining-nums;
  font-weight: 600;
  z-index: 1;
  transition: box-shadow 0.15s ease 0.05s;
}

a.footnote-ref sup {
  font-size: 0.75em;
  vertical-align: baseline;
}

/*  Expanded hover/tap area.
 */
a.footnote-ref::after {
  content: '';
  position: absolute;
  left: -40%;
  top: 5%;
  width: 180%;
  height: 120%;
}

a.footnote-ref.highlighted,
a.footnote-ref:hover,
a.footnote-ref.targeted {
  /*  o-v-o:  outline vertical offset
      o-p:    outline padding
      o-h-s:  outline horizontal spread
   */
  --o-v-o: 4px;
  --o-p: 4px;
  --o-h-s: 2px;

  box-shadow:
    var(--o-h-s) var(--o-v-o) 0 var(--o-p) var(--background-color),
    calc(-1 * var(--o-h-s)) var(--o-v-o) 0 var(--o-p) var(--background-color),
    var(--o-h-s) var(--o-v-o) 0 calc(var(--o-p) + 1px)
      var(--AT-highlighted-link-outline-color),
    calc(-1 * var(--o-h-s)) var(--o-v-o) 0 calc(var(--o-p) + 1px)
      var(--AT-highlighted-link-outline-color),
    var(--o-h-s) var(--o-v-o) 0 calc(var(--o-p) + 2px) var(--background-color),
    calc(-1 * var(--o-h-s)) var(--o-v-o) 0 calc(var(--o-p) + 2px)
      var(--background-color),
    var(--o-h-s) var(--o-v-o) 0 calc(var(--o-p) + 3px)
      var(--AT-highlighted-link-outline-color),
    calc(-1 * var(--o-h-s)) var(--o-v-o) 0 calc(var(--o-p) + 3px)
      var(--AT-highlighted-link-outline-color);
}

/*  Deal with multiple footnote superscripts one after another; per Charuru
 */
sup + sup,
a.footnote-ref {
  margin-left: 0.125em;
}

/*  ‘Foreign’ footnotes.
 */
sup a,
sub a {
  margin-left: 0.1em;
  margin-right: 0.13em;
}

sup a + a,
sub a + a {
  margin-left: 0.2em;
  margin-right: 0.13em;
}

/*=-------------------=*/
/*= Footnotes section =*/
/*=-------------------=*/

section.footnotes {
  position: relative;
  margin-top: 80px;
}

/*********************************************************/
/*  Horizontal rule at the start of the footnotes section.
 */

section.footnotes > hr:first-child {
  position: relative;
  display: flex;
  clear: both;
  margin: -0.5em 0;
}

section.footnotes > hr:first-child::after {
  content: '';
  border: 1px solid var(--AT-footnotes-section-top-rule-color);
  width: 2em;
  height: 2em;
  background-color: var(--background-color);
  background-image: none;
  z-index: 1;
  box-shadow:
    0 0 0 calc(0.5em - 1px) var(--background-color) inset,
    0 0 0 0.5em var(--AT-footnotes-section-top-rule-color) inset;
  filter: none;
  opacity: 1;
}

section.footnotes > hr:first-child::before {
  content: '';
  position: absolute;
  height: 1px;
  background-color: var(--AT-footnotes-section-top-rule-color);
  width: 100%;
  top: 50%;
}

section.footnotes > hr:first-child.highlighted::after,
section.footnotes > hr:first-child:hover::after,
section.footnotes:has(> .section-self-link:hover) > hr:first-child::after {
  border-color: var(--AT-footnote-highlighted-border-color);
  box-shadow:
    0 0 0 1px var(--background-color) inset,
    0 0 0 2px var(--AT-footnote-highlighted-border-color) inset,
    0 0 0 calc(0.5em - 1px) var(--background-color) inset,
    0 0 0 0.5em var(--AT-footnote-highlighted-border-color) inset,
    0 0 0 calc(0.5em + 1px) var(--background-color) inset,
    0 0 0 calc(0.5em + 2px) var(--AT-footnote-highlighted-border-color) inset;
}

section.footnotes > hr:first-child.highlighted::before,
section.footnotes > hr:first-child:hover::before,
section.footnotes:has(> .section-self-link:hover) > hr:first-child::before {
  background-color: var(--background-color);
  box-shadow:
    0 1px 0 0 var(--AT-footnote-highlighted-border-color) inset,
    0 -1px 0 0 var(--AT-footnote-highlighted-border-color) inset;
  height: 3px;
}

/* Separate styling for :target state (less prominent) */
section.footnotes:target > hr:first-child::after {
  border-color: var(--AT-footnote-highlighted-border-color);
  box-shadow:
    0 0 0 1px var(--background-color) inset,
    0 0 0 2px var(--AT-footnote-highlighted-border-color) inset,
    0 0 0 calc(0.5em - 1px) var(--background-color) inset,
    0 0 0 0.5em var(--AT-footnote-highlighted-border-color) inset,
    0 0 0 calc(0.5em + 1px) var(--background-color) inset,
    0 0 0 calc(0.5em + 2px) var(--AT-footnote-highlighted-border-color) inset;
}

section.footnotes:target > hr:first-child::before {
  background-color: var(--background-color);
  box-shadow:
    0 1px 0 0 var(--AT-footnote-highlighted-border-color) inset,
    0 -1px 0 0 var(--AT-footnote-highlighted-border-color) inset;
  height: 3px;
}

/*  Footnotes section self-link.
 */
section.footnotes .section-self-link {
  position: absolute;
  width: 2em;
  height: 2em;
  top: -1px;
  border: 1px solid transparent;
  left: 0;
  right: 0;
  margin: auto;
  z-index: 1;
  opacity: 0;
}

/*=----------------=*/
/*= Footnotes list =*/
/*=----------------=*/

section.footnotes > ol {
  padding-left: 2.625em;
}

section.footnotes > ol > li {
  counter-increment: footnotes;
  min-height: calc(1.75em + 1px);
  padding: 6px 0 0.25em 0;
}

/*  Footnote number.
 */
section.footnotes > ol > li::before {
  content: counter(footnotes);
  position: absolute;
  left: unset;
  right: calc(100% + 0.75em);
  top: calc(-0.125em + 5px);
  width: 1.75em;
  height: 1.75em;
  display: flex;
  justify-content: center;
  align-items: center;
  border: 1px dotted var(--AT-footnote-border-color);
  border-right-color: transparent;
  line-height: 1;
  font-variant-numeric: lining-nums;
  z-index: 1;
}

/*  Dotted vertical line.
 */
section.footnotes > ol > li::after {
  content: '';
  position: absolute;
  border-right: 1px dotted var(--AT-footnote-border-color);
  height: calc(100% + 0.125em - 4px);
  top: calc(-0.125em + 5px);
  left: calc(-0.75em - 1px);
}

/*  Footnote highlighting.
 */
section.footnotes > ol > li.targeted::before,
section.footnotes > ol > li.targeted::after,
section.footnotes > ol > li.highlighted::before,
section.footnotes > ol > li.highlighted::after,
section.footnotes > ol > li:hover::before,
section.footnotes > ol > li:hover::after {
  border-style: solid;
  border-color: var(--AT-footnote-highlighted-border-color);
  box-shadow:
    0 0 0 1px var(--background-color) inset,
    0 0 0 2px var(--AT-footnote-highlighted-border-color) inset;
}

section.footnotes > ol > li.targeted::after,
section.footnotes > ol > li.highlighted::after,
section.footnotes > ol > li:hover::after {
  border-width: 0 3px 0 0;
  border-style: double;
  left: calc(-0.75em - 3px);
}

/*  Footnote self-links.
 */
section.footnotes .footnote-self-link {
  display: initial;
  position: absolute;
  top: 2px;
  right: calc(100% + 0.75em);
  width: 1.75em;
  height: 1.75em;
  border: 1px solid transparent;
  z-index: 1;
  opacity: 0;
}

/*  Hide outside of a footnotes section.
 */
.footnote-self-link {
  display: none;
}

/*=------------------------=*/
/*= Back-to-citation links =*/
/*=------------------------=*/

.footnotes a.footnote-back {
  display: initial;
  margin: 0 0 0 0.5em;
  position: relative;
  display: inline-block;
  font-size: 1em;
  line-height: 0.5;
  border: 1px dotted var(--AT-footnote-backlink-border-color);
  top: 0.1em;
  padding: 0.25em 0.3em 0.25em 0.3em;
  width: 0.7em;
  z-index: 1;
}

/*  Hide outside of a footnotes section.
 */
a.footnote-back {
  display: none;
}

.markdownBody .footnotes a.footnote-back {
  background-image: none;
}

.markdownBody .footnotes a.footnote-back:hover {
  border-color: var(--AT-footnote-backlink-border-hover-color);
  border-style: solid;
  box-shadow:
    0 0 0 1px var(--background-color) inset,
    0 0 0 2px var(--AT-footnote-backlink-border-hover-color) inset;
}

.markdownBody .footnotes .footnote-back-block {
  text-align: right;
}

/**********************************************************/
/*  Highlighted sections. (Due to extract popups, usually.)
 */

section.highlighted {
  position: relative;
}

section.highlighted::before {
  content: '';
  display: block;
  position: absolute;
  top: -0.5em;
  left: -1.25em;
  width: calc(100% + 2em);
  height: calc(100% + 1.25em);
  outline: 3px double var(--AT-section-highlighted-border-color);
  z-index: -1;
  transition: outline 0.15s ease 0.05s;
}

section.highlight-fading::before {
  outline: 3px double transparent;
}

/***************/
/* CODE BLOCKS */
/***************/

code {
  --background-color: var(--AT-code-element-background-color);

  border: 1px solid var(--AT-code-element-border-color);
  background-color: var(--background-color);

  /*  This is currently broken in Safari. Since it’s not important enough to
      figure out a way to scope it to only non-Safari browsers, I’m disabling it
      for now. This should be revisited in a year.
          —SA 2023-09-24
   */
  /*
      -webkit-box-decoration-break: clone;
      box-decoration-break: clone;
   */

  padding: 0 4px;

  /*  Primary font: https://en.wikipedia.org/wiki/IBM_Plex
      This was chosen for its dotted/slashed zero (a sine qua non of
      coding fonts where O/0 ambiguity is fatal), and for rendering well
      on Macs.
   */
  font-family: var(--AT-monospaced-font-stack);
  /*  OpenType stylistic sets to enable single-story ‘g’ and slashed zero
      in IBM Plex Mono.
   */
  font-feature-settings: 'ss02', 'ss03';

  font-size: 0.9em;
  word-break: break-word;
}

/*  Bare-URL links will be <a><code>http://foo.bar</code></a>
 */
a code {
  font-size: 0.9em;
}

pre {
  --background-color: var(--AT-pre-element-background-color);

  overflow: auto;
  margin: 0;
  border: 1px solid var(--AT-pre-element-border-color);
  background-color: var(--background-color);
  cursor: text;
  max-height: calc(100vh - 8rem);
}

@media all and (hover: hover) {
  pre {
    overscroll-behavior: none;
  }
}

pre code {
  display: block;
  margin: 0;
  padding: 0.4rem 0.7rem;
  border: none;
  background-color: transparent;
}

/*  Truncated code blocks.
 */
div.sourceCode.truncated .truncation-notice {
  font-family: var(--AT-sans-serif-font-stack);
  text-align: center;
  height: 2em;
  line-height: 2;
  border-style: solid;
  border-color: var(--AT-pre-element-border-color);
  border-width: 0 1px 1px 1px;
}

/*  Horizontal scroll bar styles (for WebKit/Blink).
 */
pre::-webkit-scrollbar {
  height: 16px;
  background-color: var(--AT-pre-element-scrollbar-track-color);
}

pre::-webkit-scrollbar-thumb {
  background-color: var(--AT-pre-element-scrollbar-thumb-color);
  box-shadow: 0 0 0 3px var(--AT-pre-element-scrollbar-track-color) inset;
}

pre::-webkit-scrollbar-thumb:hover {
  background-color: var(--AT-pre-element-scrollbar-thumb-hover-color);
}

@media all and (max-width: 649px) {
  pre::-webkit-scrollbar {
    height: 10px;
  }
}

/*  Horizontal scroll bar styles (for Firefox).
 */
@supports (-moz-appearance: none) {
  pre {
    scrollbar-color: var(--AT-pre-element-scrollbar-thumb-color)
      var(--AT-pre-element-scrollbar-track-color);
  }

  pre:hover {
    scrollbar-color: var(--AT-pre-element-scrollbar-thumb-hover-color)
      var(--AT-pre-element-scrollbar-track-color);
  }
}

/********/
/* MATH */
/********/

/* Block math container - targets both .math.block and span.math.display inside .block */
.math.block,
.block .math.display {
  position: relative;
  display: block;
  overflow: hidden;
  border: 1px solid var(--AT-math-block-scrollbar-border-color);
}

/* Support for both old (MathJax 2) and new (MathJax 3+) output */
.math.block .mjpage,
.math.block mjx-container[display='true'],
.block .math.display .mjpage,
.block .math.display mjx-container[display='true'] {
  display: block;
  overflow: auto;
}

/* Old MathJax 2 styles */
.math.block .MJXc-display,
.block .math.display .MJXc-display {
  --background-color: var(--AT-math-block-background-color);

  display: inline-block;
  margin: 0;
  padding: 0.875em 0.75em 0.75em 0.75em;
  min-width: calc(100% - 1.5em);
  background-color: var(--background-color);
  transition: background-color 0.15s ease-out;
}

.math.block .MJXc-display.flash,
.block .math.display .MJXc-display.flash {
  --background-color: var(--AT-math-block-background-color-flash);

  transition: background-color 0.1s ease-out;
}

/* New MathJax 3+ styles */
.math.block mjx-container[display='true'],
.block .math.display mjx-container[display='true'] {
  --background-color: var(--AT-math-block-background-color);

  margin: 0;
  padding: 0.875em 0.75em 0.75em 0.75em;
  min-width: calc(100% - 1.5em);
  background-color: var(--background-color);
  transition: background-color 0.15s ease-out;
}

.math.block mjx-container[display='true'].flash,
.block .math.display mjx-container[display='true'].flash {
  --background-color: var(--AT-math-block-background-color-flash);

  transition: background-color 0.1s ease-out;
}

/*  Horizontal scroll bar styles (for WebKit/Chromium).
    */
.math.block .mjpage::-webkit-scrollbar,
.math.block mjx-container[display='true']::-webkit-scrollbar,
.block .math.display .mjpage::-webkit-scrollbar,
.block .math.display mjx-container[display='true']::-webkit-scrollbar {
  height: 14px;
  border-top: 1px solid var(--AT-math-block-scrollbar-border-color);
  background-color: var(--background-color);
}

.math.block .mjpage::-webkit-scrollbar-thumb,
.math.block mjx-container[display='true']::-webkit-scrollbar-thumb,
.block .math.display .mjpage::-webkit-scrollbar-thumb,
.block .math.display mjx-container[display='true']::-webkit-scrollbar-thumb {
  box-shadow:
    0 0 0 2px var(--background-color) inset,
    0 0 0 8px var(--AT-math-block-scrollbar-thumb-color) inset;
  border-color: var(--AT-math-block-scrollbar-border-color);
  border-style: solid;
  border-width: 1px 0 0 0;
}

.math.block .mjpage:hover::-webkit-scrollbar-thumb:hover,
.math.block mjx-container[display='true']:hover::-webkit-scrollbar-thumb:hover,
.block .math.display .mjpage:hover::-webkit-scrollbar-thumb:hover,
.block
  .math.display
  mjx-container[display='true']:hover::-webkit-scrollbar-thumb:hover {
  box-shadow:
    0 0 0 2px var(--background-color) inset,
    0 0 0 8px var(--AT-math-block-scrollbar-thumb-hover-color) inset;
}

@media all and (max-width: 649px) {
  .math.block .mjpage::-webkit-scrollbar,
  .math.block mjx-container[display='true']::-webkit-scrollbar,
  .block .math.display .mjpage::-webkit-scrollbar,
  .block .math.display mjx-container[display='true']::-webkit-scrollbar {
    height: 10px;
  }
}

/*  Horizontal scroll bar styles (for Firefox).
    */
@supports (-moz-appearance: none) {
  .math.block,
  .math.block mjx-container[display='true'],
  .block .math.display,
  .block .math.display mjx-container[display='true'] {
    scrollbar-color: var(--AT-math-block-scrollbar-thumb-color) var(--background-color);
  }

  .math.block:hover,
  .math.block mjx-container[display='true']:hover,
  .block .math.display:hover,
  .block .math.display mjx-container[display='true']:hover {
    scrollbar-color: var(--AT-math-block-scrollbar-thumb-hover-color)
      var(--background-color);
  }
}

/*  Block buttons.
 */
.math.block .block-button-bar,
.block .math.display .block-button-bar {
  position: absolute;
  top: -1px;
  right: -1px;
  border-color: var(--AT-math-block-scrollbar-border-color);
  border-style: solid;
  border-width: 1px;
}

@media all and (min-width: 650px) {
  .math.block .block-button-bar,
  .block .math.display .block-button-bar {
    opacity: 0;
    visibility: hidden;
    transition:
      opacity 0.15s ease,
      visibility 0.15s ease;
  }

  .math.block:hover .block-button-bar,
  .block .math.display:hover .block-button-bar {
    opacity: 1;
    visibility: visible;
    transition:
      opacity 0s ease 0.05s,
      visibility 0s ease 0.05s;
  }
}

.math.block .block-button-bar button,
.block .math.display .block-button-bar button {
  appearance: none;
  display: block;
  font-size: inherit;
  border: none;
  padding: 0.2em;
  width: 1.15em;
  height: 1.15em;
  box-sizing: border-box;
  background-color: var(--AT-body-background-color);
  cursor: pointer;
  overflow: hidden;
}

.math.block .block-button-bar button svg,
.block .math.display .block-button-bar button svg {
  display: block;
  width: 0.75em;
  height: 0.75em;
  opacity: 0.65;
}

@media all and (hover: hover) {
  .math.block .block-button-bar button svg,
  .block .math.display .block-button-bar button svg {
    opacity: 0.45;
  }

  .math.block .block-button-bar button:hover svg,
  .block .math.display .block-button-bar button:hover svg {
    opacity: 0.65;
  }
}

.math.block .block-button-bar button:active svg,
.block .math.display .block-button-bar button:active svg {
  transform: translateY(1px);
}

.math.block .block-button-bar button.clicked,
.block .math.display .block-button-bar button.clicked {
  background-color: var(--AT-math-block-scrollbar-border-color);
  transition: background-color 0.15s ease;
}

/* removed .scratchpad from both of these */
.math.block .block-button-bar,
.block .math.display .block-button-bar {
  display: inline-flex;
  align-items: center;
  padding: 0 0.25em;
  font-size: 0.875em;
  height: 1.25em;
  line-height: 1;
}

/*!*  Block buttons.*/
/* *!*/
/*.math.block .block-button-bar,*/
/*.block .math.display .block-button-bar {*/
/*  position: absolute;*/
/*  top: -1px;*/
/*  right: -1px;*/
/*  border-color: var(--AT-math-block-scrollbar-border-color);*/
/*  border-style: solid;*/
/*  border-width: 1px;*/
/*}*/

/*@media all and (min-width: 650px) {*/
/*  .math.block .block-button-bar,*/
/*  .block .math.display .block-button-bar {*/
/*    opacity: 0;*/
/*    visibility: hidden;*/
/*    transition: opacity 0.15s ease,*/
/*    visibility 0.15s ease;*/
/*  }*/

/*  .math.block:hover .block-button-bar,*/
/*  .block .math.display:hover .block-button-bar {*/
/*    opacity: 1.0;*/
/*    visibility: visible;*/
/*    transition: opacity 0s ease 0.05s,*/
/*    visibility 0s ease 0.05s;*/
/*  }*/
/*}*/

/*.math.block .block-button-bar button,*/
/*.block .math.display .block-button-bar {*/
/*  appearance: none;*/
/*  display: block;*/
/*  font-size: inherit;*/
/*  border: none;*/
/*  padding: 0.25em;*/
/*  width: 1.25em;*/
/*  background-color: var(--AT-body-background-color);*/
/*  cursor: pointer;*/
/*}*/

/*.math.block .block-button-bar button svg,*/
/*.block .math.display .block-button-bar button svg {*/
/*  opacity: 0.65;*/
/*}*/

/*@media all and (hover: hover) {*/
/*  .math.block .block-button-bar button svg,*/
/*  .block .math.display .block-button-bar button svg {*/
/*    opacity: 0.45;*/
/*  }*/

/*  .math.block .block-button-bar button:hover svg,*/
/*  .block .math.display .block-button-bar button:hover svg {*/
/*    opacity: 0.65;*/
/*  }*/
/*}*/

/*.math.block .block-button-bar button:active svg,*/
/*.block .math.display .block-button-bar button:active svg {*/
/*  transform: translateY(1px);*/
/*}*/

/*!* Inline math - support both MathJax 2 and 3 *!*/
/*.math.inline,*/
/*.math.inline .mjpage,*/
/*.math.inline .mjx-chtml,*/
/*.math.inline .mjx-math,*/
/*.math.inline .mjx-mrow,*/
/*.math.inline mjx-container,*/
/*.math.inline mjx-math {*/
/*  display: inline;*/
/*  white-space: normal;*/
/*}*/

/********/
/* MISC */
/********/

/*  Ordinals.
 */
sup.ordinal {
  text-transform: lowercase;
  top: 0.1em;
  text-shadow: none;
}

.heading sup.ordinal {
  font-variant-caps: small-caps;
}

.markdownBody a sup.ordinal {
  padding: 0;
}

/*  Inflation adjustments.

    Make sure that adjusted prices move as a block: no breaking in the middle
    between the price & sup/sub; this works better than trying to use no-break
    Unicode entities.
 */
span.inflation-adjusted {
  white-space: nowrap;
}

span.inflation-adjusted .subsup {
  align-items: flex-end;
  bottom: 0;
}

/*  Fixes a bug, not with thickness of the strikethrough line, but its position.
    (No, I have no idea why it works like that.)
 */
del {
  text-decoration-thickness: from-font;
}

/*  LaTeX/TeX: Format the logotypes correctly (a higher up, e lower)
    (borrowed from https://latex.now.sh/ )
    */
.logotype-latex .logotype-latex-a {
  text-transform: uppercase;
  font-size: 0.79em;
  vertical-align: 0.24em;
  margin-left: -0.32em;
  margin-right: -0.02em;
  padding-left: 0.02em;
  line-height: 1ex;
}

.logotype-latex .logotype-latex-e {
  text-transform: uppercase;
  vertical-align: -0.5ex;
  margin-left: -0.13em;
  margin-right: -0.1em;
  line-height: 1ex;
}

.logotype-tex sub {
  text-transform: uppercase;
  vertical-align: -0.5ex;
  margin-left: -0.08em;
  margin-right: -0.08em;
  font-size: 1em;
}

/*  Scratchpad for copy operations.
 */
#scratchpad {
  position: absolute;
  top: 0;
  left: 0;
  width: 0;
  height: 0;
  opacity: 0;
  z-index: -1;
  pointer-events: none;
}

/*	Script tags.
 */
script {
  user-select: none;
}

/*************/
/* SIDENOTES */
/*************/

#sidenote-column-left,
#sidenote-column-right {
  width: calc(50vw - (var(--AT-body-max-width) / 2 + 96px));
  max-width: var(--AT-sidenotes-max-width);
  pointer-events: none;
}

#sidenote-column-left,
#sidenote-column-right {
  position: absolute;
  top: 0;
  height: 100%;
  z-index: 1;
  pointer-events: none;
}

/*  Elevate sidenote column z-index when a sidenote is hovered/highlighted
    to ensure it appears above sticky table headers in full-width tables.
*/
#sidenote-column-left:has(.sidenote:hover),
#sidenote-column-left:has(.sidenote.highlighted),
#sidenote-column-right:has(.sidenote:hover),
#sidenote-column-right:has(.sidenote.highlighted) {
  z-index: 10;
}

#sidenote-column-left {
  right: calc(100% + 64px);
}

#sidenote-column-right {
  left: calc(100% + 64px);
}

#sidenote-column-left:empty,
#sidenote-column-right:empty {
  display: none;
}

/*=-----------------=*/
/*= Sidenote blocks =*/
/*=-----------------=*/

#markdownBody .sidenote {
  --sidenote-padding: 10px;
  --sidenote-border-width: 3px;
  --text-indent: 1.75em;

  position: absolute;
  left: 0;
  width: 100%;
  opacity: 0.85;
  padding: 2em 0 0 0;
  font-size: 0.85em;
  line-height: calc(1.3 / 0.85);
  transition:
    opacity 0.25s ease-in,
    transform 0.25s ease-in,
    top 0.15s ease-out;
  pointer-events: auto;
}

#markdownBody .sidenote.displaced {
  transition:
    opacity 0.25s ease-out,
    transform 0.25s ease-out;
}

#markdownBody .sidenote.hidden {
  display: none;
}

#markdownBody .sidenote:hover,
#markdownBody .sidenote.targeted,
#markdownBody .sidenote.displaced,
#markdownBody .sidenote.highlighted {
  background-color: var(--background-color);
  opacity: 1;
  box-shadow: 0 0 0 16px var(--background-color);
}

#markdownBody .sidenote.targeted {
  z-index: 1;
}

#markdownBody .sidenote.displaced {
  z-index: 2;
}

#markdownBody .sidenote.highlighted,
#markdownBody .sidenote:hover {
  z-index: 3;
}

/*  This provides a solid hover margin.
    */
#markdownBody .sidenote::after {
  content: '';
  position: absolute;
  width: calc(100% + 2 * var(--sidenote-padding));
  height: calc(100% + 2 * var(--sidenote-padding));
  top: calc(-1 * (var(--sidenote-padding) + var(--sidenote-border-width)));
  left: calc(-1 * (var(--sidenote-padding) + var(--sidenote-border-width)));
  border: 0px solid var(--background-color);
  transition:
    border-color 0.15s ease 0.05s,
    border-style 0.15s ease 0.05s;
}

#markdownBody .sidenote:hover::after,
#markdownBody .sidenote.targeted::after,
#markdownBody .sidenote.displaced::after,
#markdownBody .sidenote.highlighted::after {
  border: 3px double var(--AT-sidenote-highlight-box-shadow-color);
}

#markdownBody .sidenote.cut-off::before {
  content: '…';
  position: absolute;
  border: 1px dotted var(--AT-sidenote-border-color);
  top: calc(100% - 1px);
  left: 0;
  right: 0;
  margin: auto;
  width: fit-content;
  z-index: 2;
  background-color: var(--background-color);
  padding: 0.125em 0.5em 0.5em 0.5em;
  font-size: 1.25em;
  font-weight: 600;
  line-height: 0.5;
  pointer-events: none;
}

#markdownBody .sidenote.cut-off:hover::before {
  visibility: hidden;
}

#markdownBody .sidenote.cut-off.hide-more-indicator::before {
  visibility: hidden;
}

/*=-------------------=*/
/*= Sidenote wrappers =*/
/*=-------------------=*/

/*  Outer wrapper (scrolls).
    */
.sidenote-outer-wrapper {
  max-height: 600px;
  overflow: hidden;
  position: relative;
  z-index: 1;
  border-style: dotted;
  border-color: var(--AT-sidenote-border-color);
  border-width: 1px 0;
}

#markdownBody .sidenote:hover .sidenote-outer-wrapper,
#markdownBody .sidenote.displaced .sidenote-outer-wrapper,
#markdownBody .sidenote.highlighted .sidenote-outer-wrapper {
  /*  1px for inner border; 1px for minimum distance from edge. */
  max-height: calc(
    100vh -
      (2em + 2 * (var(--sidenote-padding) + var(--sidenote-border-width) + 1px + 1px))
  );
}

#markdownBody .sidenote.cut-off .sidenote-outer-wrapper {
  overflow-y: scroll;
  overscroll-behavior: none;
  width: 100%;
  padding: 0 0.5em 0 0;
}

/*  Scroll bar styles (for WebKit/Chromium).
    */
#markdownBody .sidenote.cut-off .sidenote-outer-wrapper::-webkit-scrollbar {
  width: 12px;
}

#markdownBody .sidenote.cut-off .sidenote-outer-wrapper::-webkit-scrollbar-thumb {
  background-image: var(--AT-checkerboard-scrollbar-background-image);
  background-size: 2px;
  box-shadow: 0 0 0 2px var(--background-color) inset;
}

#markdownBody .sidenote.cut-off .sidenote-outer-wrapper::-webkit-scrollbar-thumb:hover {
  background-image: var(--AT-checkerboard-scrollbar-hover-background-image);
}

/*  Scroll bar styles (for Firefox).
    */
@supports (-moz-appearance: none) {
  #markdownBody .sidenote.cut-off .sidenote-outer-wrapper {
    scrollbar-color: var(--AT-sidenote-scrollbar-thumb-color) var(--background-color);
  }

  #markdownBody .sidenote.cut-off .sidenote-outer-wrapper:hover {
    scrollbar-color: var(--AT-sidenote-scrollbar-thumb-hover-color)
      var(--background-color);
  }
}

/*  Inner wrapper (does not scroll; stretches to height of content).
    */
.sidenote-inner-wrapper {
  position: relative;
  margin: 0.5em 0;
}

/*  Ensure content is interactive.
    */
.sidenote-inner-wrapper > * {
  position: relative;
  z-index: 1;
}

/*=--------------------------------------=*/
/*= Sidenote contents layout corrections =*/
/*=--------------------------------------=*/

#markdownBody .sidenote {
  --base-block-spacing: 0.2em;
}

#markdownBody .sidenote .list {
  --list-left-padding: 1.75em;
}

#markdownBody .sidenote li p {
  text-align: left;
}

#markdownBody .sidenote .footnote-back {
  vertical-align: text-top;
}

#markdownBody .sidenote blockquote > * {
  line-height: calc(1.25 / (var(--blockquote-font-size-scaling-factor) * 0.85));
}

/*=-------------------------------=*/
/*= Sidenote self-links (numbers) =*/
/*=-------------------------------=*/

#markdownBody .sidenote > .sidenote-self-link {
  font-weight: 600;
  position: absolute;
  top: -1px;
  background-image: none;
  border-style: dotted;
  border-color: var(--AT-sidenote-self-link-border-color);
  border-width: 1px 1px 0px 1px;
  width: 2em;
  height: 2em;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1;
  transition:
    border-color 0.15s ease 0.05s,
    border-style 0.15s ease 0.05s;
}

#markdownBody #sidenote-column-left .sidenote > .sidenote-self-link {
  right: 0;
}

#markdownBody #sidenote-column-right .sidenote > .sidenote-self-link {
  left: 0;
}

#markdownBody .sidenote.targeted > .sidenote-self-link,
#markdownBody .sidenote > .sidenote-self-link:hover {
  border-width: 3px;
  border-style: double;
  top: -3px;
}

#markdownBody #sidenote-column-left .sidenote.targeted > .sidenote-self-link,
#markdownBody #sidenote-column-left .sidenote > .sidenote-self-link:hover {
  right: -2px;
}

#markdownBody #sidenote-column-right .sidenote.targeted > .sidenote-self-link,
#markdownBody #sidenote-column-right .sidenote > .sidenote-self-link:hover {
  left: -2px;
}

#markdownBody .sidenote.targeted > .sidenote-self-link::before,
#markdownBody .sidenote > .sidenote-self-link:hover::before {
  content: '';
  display: block;
  position: absolute;
  bottom: -3px;
  width: calc(50vw - (var(--AT-body-max-width) / 2 + 96px) + 10px);
  max-width: var(--AT-sidenotes-max-width);
  border-bottom: 3px double var(--AT-sidenote-self-link-border-color);
  transition:
    border-color 0.15s ease 0.05s,
    border-style 0.15s ease 0.05s;
}

#markdownBody #sidenote-column-left .sidenote.targeted > .sidenote-self-link::before,
#markdownBody #sidenote-column-left .sidenote > .sidenote-self-link:hover::before {
  right: -1px;
}

#markdownBody #sidenote-column-right .sidenote.targeted > .sidenote-self-link::before,
#markdownBody #sidenote-column-right .sidenote > .sidenote-self-link:hover::before {
  left: -1px;
}

/*=------------------------------------------=*/
/*= Sidenote back-to-citation links (arrows) =*/
/*=------------------------------------------=*/

#markdownBody .sidenote .footnote-back svg {
  transition: transform 0.25s ease-out;
}

/****************/
/* MARGIN NOTES */
/****************/
/* display inline on mobile/narrow windows; on sufficiently-wide screens, pop out as number-less sidenotes */

.marginnote {
  /* bolding turns out to be too obtrusive for users' liking; italicized both inline & popped-out */
  font-style: italic;
  color: var(--AT-body-text-color);
  font-family: var(--AT-serif-font-stack);
}

.marginnote.inline {
  color: inherit;
  font-variant-caps: initial;
}

/*	On viewports wide enough to display margin notes, enable relative-to-graf
	margin note positioning.
 */
@media all and (min-width: 1497px) {
  #markdownBody p.has-margin-note {
    position: relative;
  }
}

#markdownBody .marginnote.sidenote {
  --text-hyphenation: none;
  --background-color: transparent;

  display: flex;
  justify-content: right;
  width: calc(50vw - (var(--AT-body-max-width) / 2 + 96px));
  max-width: var(--AT-sidenotes-max-width);
  right: calc(100% + 64px);
  left: unset;
  top: max(var(--marginnote-vertical-position) - 1.35em, 0px);

  /*  We inherit left and right padding from .sidenote class. */
  padding-top: 0.2em;
  padding-bottom: 0.5em;

  font-size: calc(var(--AT-body-text-font-size) * 0.85);
  text-align: left;
  opacity: 0.85;
  z-index: 1;
}

#markdownBody .marginnote.sidenote .marginnote-inner-wrapper {
  display: block;
  width: fit-content;
}

#markdownBody .marginnote.sidenote:hover {
  box-shadow: none;
}

#markdownBody .marginnote.sidenote::after {
  display: none;
}

/*  Margin notes within admonitions need special layout.
    This is based on the width of the admonition icon area.
 */
#markdownBody .admonition .marginnote.sidenote {
  width: calc(
    50vw - ((var(--AT-body-max-width) + (2.875em / (0.85 / 0.875))) / 2 + 96px)
  );
  right: calc(var(--AT-body-max-width) + (2.875em / (0.85 / 0.875)) + 64px);
}

/*  Special “icon only” margin notes.
 */
#markdownBody .marginnote.only-icon {
  pointer-events: none;
}

#markdownBody .marginnote.only-icon.inline {
  margin-right: 0.2em;
}

#markdownBody .marginnote.only-icon.sidenote {
  font-size: inherit;
  padding-top: 0.1em;
}

/*=--------------=*/
/*= Margin notes =*/
/*=--------------=*/

/*  On wide viewports, hide the margin notes until it is determined which layout
    form it should take (‘sidenote’ or ‘inline’).
 */
@media all and (min-width: 1497px) {
  .marginnote:not(.inline):not(.sidenote) {
    display: none;
  }
}

/*************/
/* EPIGRAPHS */
/*************/
/*  Loosely inspired by https://edwardtufte.github.io/tufte-css/#epigraphs
 */

.epigraph {
  display: flow-root;
  margin: auto;
  padding: 0.75em 2.5em;
  overflow: hidden;
}

.epigraph blockquote {
  --background-color: inherit;

  padding: 0;
  border: none;
  position: relative;
  z-index: 1;
  width: fit-content;
  margin: auto;
}

.epigraph blockquote p {
  font-size: inherit;
  font-style: italic;
  background-color: inherit;
}

/*  Reverse back to normal when italics are used inside an epigraph, or final block.
 */
.epigraph blockquote p:only-child em,
.epigraph blockquote p:not(:last-child) em {
  font-style: normal;
  margin: 0 0 0 0.125em;
}

.epigraph blockquote p:last-child:not(:only-child) {
  margin: 0.5em 0 0 0;
  text-align: right;
  font-size: 0.875em;
  font-style: normal;
}

.epigraph blockquote blockquote p,
.epigraph blockquote blockquote p:last-child:not(:only-child) {
  text-align: var(--text-alignment);
}

.epigraph > blockquote::before,
.epigraph > blockquote::after {
  display: block;
  position: absolute;
  font-size: 2.5em;
  color: var(--AT-epigraph-quotation-mark-color);
}

.epigraph > blockquote::before {
  content: '\201C';
  left: -1em;
  top: -0.56em;
}

.epigraph > blockquote::after {
  content: '\201D';
  right: -1em;
  bottom: -1.12em;
}

@media all and (max-width: 649px) {
  .epigraph {
    padding: 1.5em 0.75em;
    font-size: 0.95em;
  }

  .epigraph > blockquote::before {
    left: -0.3em;
    top: -0.9em;
  }

  .epigraph > blockquote::after {
    right: -0.3em;
    bottom: -1.4em;
  }
}

/*	Narrow epigraphs (desktop only).
 */
.epigraph.narrow {
  padding: 1.5em 0.75em;
}

.epigraph.narrow > blockquote::before {
  left: -0.3em;
  top: -0.9em;
}

.epigraph.narrow > blockquote::after {
  right: -0.3em;
  bottom: -1.4em;
}

/*	“Poem”-style epigraphs.
 */
.epigraph.poem p {
  text-align: left;
  text-indent: -2.5em;
  padding-left: 2.5em;
}

/**************/
/*  Exceptions.
 */

/*  EPITAPH (eg /LARPing)
 */
.markdownBody p.text-center {
  text-align: center;
  text-indent: 0;
}

.markdownBody p.text-right {
  text-align: right;
  text-indent: 0;
}

/***************/
/* ADMONITIONS */
/***************/
/*  Highlighted boxes: ‘admonitions’ are small break-out boxes with notes, tips,
    warnings, etc. for the reader.

    These are particularly useful in didactic technical writing, where there are
    many ways to slip up while using or coding something.

    Available (in increasing order of minatoriness):
    ‘tip’, ‘note’, ‘warning’, ‘error’.

    Based on Markdeep's implementation:
    https://casual-effects.com/markdeep/features.md.html#basicformatting/admonitions
    (which appears loosely inspired by Wikipedia's notification templates like
    `{{NPOV}}`) and modified to grayscale (increasing intensity == increasing
    warning) for Gwern.net.

    Usage examples:

    - <div class="admonition tip"><div class="admonition-title">Tip title (optional)</div> text</div>
    - <div class="admonition note"><div class="admonition-title">Note title (*)</div> text</div>
    - <div class="admonition warning"><div class="admonition-title">Warning title (*)</div> text</div>
    - <div class="admonition error"><div class="admonition-title">Error title (*)</div> text</div>
 */
.admonition {
  display: flow-root;
  font-family: var(--AT-sans-serif-font-stack);
  font-size: 0.875em;
  position: relative;
  padding: 0.75em 1.25em 0.875em 1.125em;
  border-left: 2.875em solid var(--admonition-left-border-color);
  background-color: var(--background-color);
}

.admonition.note {
  --background-color: var(--AT-admonition-note-background-color);
  --admonition-left-border-color: var(--AT-admonition-note-left-border-color);
}

.admonition.tip {
  --background-color: var(--AT-admonition-tip-background-color);
  --admonition-left-border-color: var(--AT-admonition-tip-left-border-color);
}

.admonition.warning {
  --background-color: var(--AT-admonition-warning-background-color);
  --admonition-left-border-color: var(--AT-admonition-warning-left-border-color);

  color: var(--AT-admonition-warning-text-color);
}

.admonition.error {
  --background-color: var(--AT-admonition-error-background-color);
  --admonition-left-border-color: var(--AT-admonition-error-left-border-color);

  color: var(--AT-admonition-error-text-color);
}

.admonition-title {
  font-weight: bold;
}

.admonition::before {
  content: '';
  width: 2.875em;
  height: 100%;
  position: absolute;
  top: 0.125em;
  right: 100%;
  padding: 0.6em;
  box-sizing: border-box;
  background-origin: content-box;
  background-clip: content-box;
  background-repeat: no-repeat;
}

.admonition.tip::before {
  background-image: url('/static/img/icon/icons.svg#info-circle-regular');
}

.admonition.note::before {
  background-image: url('/static/img/icon/icons.svg#hand-point-right-regular');
  filter: invert(1);
}

.admonition.warning::before {
  background-image: url('/static/img/icon/icons.svg#triangle-exclamation-regular');
  filter: invert(1);
}

.admonition.error::before {
  background-image: url('/static/img/icon/icons.svg#skull-crossbones-solid');
  padding: 0.75em;
  top: 0;
  filter: invert(1);
}

.admonition code {
  --AT-code-element-background-color: transparent;

  border: none;
  padding-left: 0;
  font-size: unset;
}

.admonition .footnote-ref {
  text-shadow: none;
}

/*****************/
/* MULTI-COLUMNS */
/*****************/
/*  Inspired by Markdeep:
    https://casual-effects.com/markdeep/features.md.html#multiplecolumns
    (limited multi-column support as a div class annotation)

    This is particularly useful for extremely long (‘skinny’) lists where items
    tend to be short, such as in /dnm-archive#overall-coverage or /replication

    Uses CSS3 columns:
    https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Columns/Using_multi-column_layouts
    https://www.caniuse.com/#feat=multicolumn

    Currently limited to lists due to issues with hidden:overflow in FF
    and sidenotes.js in Chrome.
 */

.markdownBody .columns > .list {
  --text-alignment: left;

  column-width: 18em;
  column-gap: 3em;
}

.markdownBody .columns .list li {
  break-inside: avoid;
}

/**********************/
/*  Figures in columns.
 */

.markdownBody .columns.figures > ul {
  --list-left-padding: 0;

  column-gap: 1.5em;
}

.markdownBody .columns.figures > ul > li::before {
  display: none;
}

.markdownBody .columns.figures figure {
  max-width: unset;
  margin: 0 0 1em 0;
}

.markdownBody .columns.figures figure img,
.markdownBody .columns.figures figure svg,
.markdownBody .columns.figures figure video,
.markdownBody .columns.figures figure audio {
  max-width: 100%;
}

/*  Special styles for special browsers.
    */
@supports (-moz-appearance: none) {
  .markdownBody .columns.figures figcaption {
    line-height: initial;
  }
}

/**************/
/* INDEX PAGE */
/**************/

.index-intro {
  margin-bottom: 1.5em;
}

.index-intro p:last-child {
  margin-bottom: 0;
}

.index-divider {
  border: none;
  border-top: 1px solid var(--AT-horizontal-rule-stroke-color, currentColor);
  opacity: 0.3;
  margin: 2em 0;
}

.index-sections {
  display: flex;
  flex-wrap: wrap;
  gap: 2em;
}

.index-column {
  flex: 1 1 calc(50% - 1em);
  min-width: 250px;
  max-width: calc(50% - 1em);
}

.index-column h2 {
  font-size: 1.25em;
  margin: 0 0 0.75em 0;
  font-variant-caps: small-caps;
  letter-spacing: 0.02em;
}

.index-column h2 a {
  color: inherit;
  text-decoration: none;
}

.index-column h2 a:hover {
  text-decoration: underline;
}

.index-post-list {
  margin: 0;
  padding: 0;
}

.index-post-list li {
  display: flex;
  justify-content: space-between;
  align-items: baseline;
  gap: 0.5em;
}

.index-post-list li a {
  flex: 1;
  min-width: 0;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.index-post-date {
  font-size: 0.85em;
  color: var(--AT-body-text-color);
  opacity: 0.6;
  flex-shrink: 0;
  font-variant-numeric: tabular-nums;
}

.index-more {
  margin-top: 0.75em;
  font-size: 0.9em;
}

.index-more a {
  font-style: italic;
}

@media all and (max-width: 549px) {
  .index-sections {
    flex-direction: column;
    gap: 1.5em;
  }

  .index-column {
    flex: 1 1 100%;
  }

  .index-column h2 {
    font-size: 1.15em;
  }
}

/***********************/
/* FULL-WIDTH ELEMENTS */
/***********************/

.width-full {
  z-index: 1;
}

/***********/
/* FIGURES */
/***********/
/*  Additional figure styles.
 */

figure .image-wrapper {
  position: relative;
  display: block;
  margin: auto;
  width: fit-content;
  max-width: 100%;
}

figure .image-wrapper::before {
  --dark-mode-invert-filter: invert(1);

  content: '';
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background-color: var(--background-color);
}

/*  Figures in sidenotes should take up the full width of the sidenote.
    */
#markdownBody .sidenote figure {
  max-width: calc(100% - 2px);
}

/*  Figures in blockquotes.
 */
blockquote figure.outline-not img,
blockquote figure.outline-not video {
  outline: 1px solid var(--border-color);
}

blockquote figure.outline-not .caption-wrapper {
  outline: 1px solid var(--border-color);
}

/*  Image alt-text.
    */
img::before {
  content: attr(alt);
  font-family: var(--AT-sans-serif-font-stack);
  display: flex;
  flex-flow: column;
  justify-content: center;
  padding: 0.5em 0.75em;
  background-color: var(--background-color);
  text-align: center;
  box-sizing: border-box;
  height: 100%;
}

/**********/
/* TABLES */
/**********/

table {
  margin: 0 auto;
  padding: 0;
  border-collapse: collapse;
  width: 100%;
  font-size: 0.75em;
  border-width: 0;
}

.table-wrapper {
  margin-left: auto;
  margin-right: auto;
  border-width: 2px 0;
  border-color: var(--AT-table-border-color);
  border-style: solid;
}

.table-scroll-wrapper {
  overflow-x: auto;
  overflow-y: auto;
  max-height: calc(100vh - 8rem);
  overscroll-behavior: none;
}

/*=-------------------=*/
/*= Full-width tables =*/
/*=-------------------=*/

.width-full table {
  width: fit-content;
  background-color: var(--background-color);
}

/*=--------------=*/
/*= Small tables =*/
/*=--------------=*/

.table-wrapper.table-small {
  width: fit-content;
}

/*  Floating small tables.
    NOTE: we do not float small tables by default, although this is an appealing idea because so many small tables could be floated usefully, especially in popups.
    But when tried on heavy users like /clone#mackenzie-et-al-1986 or /ab-testing, floated small tables interact badly with code blocks/paragraphs/figures. One would need more intelligence than just making them all float left (or right), so they are left unfloated and must be manually floated (usually in a left/right zig-zag).
 */
@media all and (min-width: 650px) {
  .table-small.float-left {
    clear: right;
  }

  .table-small.float-right {
    clear: left;
  }
}

/*=-------------=*/
/*= Table parts =*/
/*=-------------=*/

table caption {
  --text-hyphenation: none;
  --text-alignment: center;

  padding: 0.25em 0.75em;
  font-style: italic;
  font-size: 1.25em;
  border-bottom: 2px solid var(--AT-table-caption-border-color);
  background-color: inherit;
}

/*
Sticky table headers: the column labels of larger tables are 'sticky', and will remain visible when the reader scrolls through a large table, so they can see at a glance what each column contains.

Implementation: This is supported natively in CSS by `position:sticky`.
However, the naive use of sticky table headers is fragile and runs into many problems (eg disappearing borders <https://stackoverflow.com/questions/50361698/border-style-do-not-work-with-sticky-position-element>, overflows, or _z_-index bugs where the sticky header is *below* table elements).
It works mostly in: tables in the base page, not in a collapse, not wider than the page, not in a blockquote, not in popups/popovers, etc.
Because of the limited scope & many bugs, the naive approach was not worth implementing: small simple tables don't need it, while the large complex tables that do are relatively rare & would probably trigger bugs.

So we implement them in a more complex way to work around bugs.
To limit sticky issues, we only do sticky headers on 'large' tables where 'large' > 1 viewport height (ie. a table which would require scrolling). So the table becomes v-scrollable within an inner scroll container (set to be substantially smaller than the window size so there is plenty of room to click on and 'untrap' the mouse), like code-blocks on mobile.
Within that scroll container, the headers are sticky.
Since they are confined to the inner container and don't need to interact with any other page elements, most of the problems of sticky elements are avoided.
Then other issues are dealt with by a bunch of small CSS tweaks.
*/
table thead {
  position: sticky;
  top: -1px;
  z-index: 2;
  background-color: var(--background-color);
  box-shadow: 0 -1px 0 0 var(--AT-table-row-horizontal-border-color) inset;
}

table tbody {
  --text-alignment: left;
}

table th,
table td {
  padding: 7px 10px;
  line-height: 1.35;
}

table th {
  --text-hyphenation: none;

  font-weight: bold;
  border-bottom: 1px solid var(--AT-table-row-horizontal-border-color);
  text-align: left;
}

table td {
  vertical-align: top;
}

table th + th,
table td + td {
  border-left: 1px solid var(--background-color);
}

table td > code {
  word-break: normal;
}

/*  Scroll bar styles (for WebKit/Chromium).
    */
.table-scroll-wrapper::-webkit-scrollbar {
  width: 16px;
  height: 16px;
}

@media all and (max-width: 649px) {
  .table-scroll-wrapper::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }
}

.table-scroll-wrapper::-webkit-scrollbar-thumb {
  background-image: var(--AT-checkerboard-scrollbar-background-image);
  background-size: 2px;
}

.table-scroll-wrapper::-webkit-scrollbar-thumb:horizontal {
  box-shadow:
    0 2px 0 0 var(--background-color) inset,
    0 0 0 1px var(--AT-table-scrollbar-border-color) inset,
    0 2px 0 1px var(--AT-table-scrollbar-border-color) inset;
}

.table-scroll-wrapper::-webkit-scrollbar-thumb:vertical {
  box-shadow:
    0 -1px 0 0 var(--AT-table-scrollbar-border-color),
    0 1px 0 0 var(--AT-table-scrollbar-border-color),
    1px 0 0 0 var(--AT-table-scrollbar-border-color) inset,
    -1px 0 0 0 var(--AT-table-scrollbar-border-color) inset;
}

.table-scroll-wrapper::-webkit-scrollbar-thumb:hover {
  background-image: var(--AT-checkerboard-scrollbar-hover-background-image);
}

.table-scroll-wrapper::-webkit-scrollbar-track:vertical {
  border-left: 1px dotted var(--AT-table-scrollbar-border-color);
}

/*  Scroll bar styles (for Firefox).
    */
@supports (-moz-appearance: none) {
  .table-scroll-wrapper {
    scrollbar-color: var(--AT-table-scrollbar-thumb-color) var(--background-color);
  }

  .table-scroll-wrapper:hover {
    scrollbar-color: var(--AT-table-scrollbar-thumb-hover-color) var(--background-color);
  }
}

/*  Add little icons to tables handled by tablesorter.js
    to advertise that they are sortable.
    https://mottie.github.io/tablesorter/docs/#Configuration
    */
th.tablesorter-header {
  background-image: url('/static/img/tablesorter/tablesorter-bg.gif');
  cursor: pointer;
  font-weight: bold;
  background-repeat: no-repeat;
  background-position: center left;
  padding-left: 20px;
}

th.tablesorter-header:hover {
  background-color: var(--AT-table-column-heading-hover-background-color);
  background-clip: padding-box;
}

th.tablesorter-header:focus {
  outline: none;
}

th.tablesorter-headerAsc {
  background-image: url('/static/img/tablesorter/tablesorter-asc.gif');
}

th.tablesorter-headerDesc {
  background-image: url('/static/img/tablesorter/tablesorter-desc.gif');
}

th.tablesorter-headerAsc,
th.tablesorter-headerDesc,
th.tablesorter-headerAsc:hover,
th.tablesorter-headerDesc:hover {
  background-color: var(--AT-table-sorted-column-heading-background-color);
  color: var(--AT-table-sorted-column-heading-text-color);
  text-shadow:
    0.5px 0.5px 0 var(--AT-table-sorted-column-heading-text-shadow-color),
    0 0 1px var(--AT-table-sorted-column-heading-text-shadow-color);
}

/*  Zebra-stripe tables (CSS3); from Twitter’s bootstrap package.
    NOTE: we tried 3-cycle zebra striping tables, but didn’t pass muster.
    */
table tr:nth-child(odd) td {
  --background-color: var(--AT-table-zebra-stripe-alternate-row-background-color);

  background-color: var(--background-color);
}

/*  Small tables don’t get zebra-striped.
 */
.table-small table tr:nth-child(odd) td {
  --background-color: inherit;
}

/*  Tables in blockquotes.
 */
blockquote table {
  font-size: 0.7em;
}

blockquote table tr:nth-child(odd) td {
  --background-color: var(--AT-body-background-color);
}

/*  Adjustment for nested tables in Wikipedia infoboxes.
 */
blockquote table table {
  font-size: 1em;
}

/*  Fix for z-index bug due to link styles.
 */
table .has-content.has-indicator-hook {
  z-index: 0;
  -webkit-box-decoration-break: clone;
  box-decoration-break: clone;
}

/*  Hover row outline.
 */
table tbody tr:hover {
  outline: 1px dotted var(--AT-table-row-hover-outline-color);
}

/***********/
/* NUMBERS */
/***********/
/*  ‘Tabular figures’ to make numbers line up in tables or other
    monospace/code like contexts:

    https://practicaltypography.com/alternate-figures.html#tabular-and-proportional-figures
    https://helpx.adobe.com/fonts/using/open-type-syntax.html#tnum
 */
/*  Skip old-style figures in elements with underlining, to reduce the need to
    cross the underline with skip-ink
 */
table,
code,
pre,
a,
h1,
h2,
h3,
h4,
h5,
h6 {
  font-variant-numeric: tabular-nums;
}

/*******************/
/*  Figure contents.
 */

.figure-outer-wrapper {
  display: flex;
  flex-flow: column;
  margin: auto;
  width: fit-content;
  max-width: 100%;
}

figure img,
figure video,
figure svg {
  position: relative;
  display: block;
  max-height: calc(100vh - 8rem);
  max-width: 100%;
  height: auto;
  width: auto;
  margin: 0 auto;

  /*  This is to prevent overflow of image alt-text in Chrome.
   */
  overflow: hidden;
}

figure img,
figure video {
  outline: 1px solid var(--AT-figure-outline-color);
}

figure.outline-not img,
figure.outline-not video {
  outline: none;
}

figure audio {
  display: block;
  margin: 0 auto;
  height: 54px;
  border-radius: 27px;
  position: relative;
  z-index: 1;
  top: 1px;
  box-sizing: border-box;
  border: 1px solid transparent;
}

/*  Special styles for special browsers.
    */
@supports (-moz-appearance: none) {
  figure audio {
    height: 42px;
    border-radius: 21px;
  }
}

figure audio:hover {
  border-color: var(--AT-figure-outline-color);
  box-shadow:
    0 0 4px 0 var(--AT-figure-outline-color) inset,
    0 0 4px 0 var(--AT-figure-outline-color);
}

/*******************/
/*  Figure captions.
    */

figcaption {
  font-size: 0.9em;
  line-height: 1.5;
  margin: auto;
  padding: 0.5em 0.875em calc(0.5em + 1px) 0.875em;
  width: fit-content;
  background-color: var(--background-color);
}

@media all and (max-width: 649px) {
  figcaption {
    font-size: 0.875em;
  }
}

.markdownBody figcaption {
  --text-alignment: left;
}

figcaption p:first-of-type {
  font-weight: bold;
}

/*figcaption strong {*/
/*  font-weight: inherit;*/
/*  font-variant-caps: small-caps;*/
/*}*/

.caption-wrapper {
  display: block;
  outline: 1px solid var(--AT-figure-caption-outline-color);
  margin: 1px auto 0 auto;
  width: 100%;
}

figure.outline-not .caption-wrapper {
  outline: none;
}

/***********************************************************************/
/*  Enable the various `![caption](/doc/foo/bar.jpg){.width-full}` uses;
    analogous to width-full tables
 */
figure.width-full {
  position: relative;
  max-width: unset;
  clear: both;
}

/****************/
/*  Figures misc.
 */

/*  Figure in the page abstract.
 */
.page-abstract .page-thumbnail-figure.float-not {
  max-width: unset;
}

/*  Dotted underlines for annotated links.
 */
.markdownBody a.has-annotation,
.markdownBody a.has-annotation-partial {
  background-image: linear-gradient(
    to right,
    var(--link-underline-gradient-line-color) 50%,
    var(--link-underline-background-color) 50%
  );
  background-size: 2px 1px;
}

.markdownBody a.has-annotation.decorate-not {
  background-image: none;
}

/*  Colored (on hover) links.
 */
a[data-link-icon-color]:hover {
  --link-underline-gradient-line-color: var(--link-icon-color-hover);
}

/* Tooltip system */
.tooltip {
  font-family: var(--AT-serif-font-stack);
  background: var(--tooltip-bg, #333);
  color: var(--tooltip-color, white);
  padding: 8px 12px;
  border-radius: 6px;
  font-size: 14px;
  line-height: 1.4;
  z-index: 9999;
  box-shadow: 0 4px 14px rgba(0, 0, 0, 0.15);
  word-wrap: break-word;
  position: fixed;
  max-width: var(--tooltip-max-width, 320px);
  white-space: normal;
  overflow-wrap: anywhere;
  word-break: normal;
}

/* Tooltip variants using CSS custom properties */
.tooltip-dark {
  --tooltip-bg: #333;
  --tooltip-color: white;
}

.tooltip-light {
  --tooltip-bg: white;
  --tooltip-color: #333;
  border: 1px solid #ddd;
}

.tooltip-primary {
  --tooltip-bg: #007bff;
  --tooltip-color: white;
}

.tooltip-success {
  --tooltip-bg: #28a745;
  --tooltip-color: white;
}

.tooltip-warning {
  --tooltip-bg: #ffc107;
  --tooltip-color: #212529;
}

.tooltip-danger {
  --tooltip-bg: #dc3545;
  --tooltip-color: white;
}

.tooltip-trigger {
  cursor: help;
}

/* Tooltip arrow system */
.tooltip-arrow,
.tooltip-arrow::before {
  position: absolute;
  width: 8px;
  height: 8px;
  background: inherit;
}

.tooltip-arrow {
  visibility: hidden;
}

.tooltip-arrow::before {
  visibility: visible;
  content: '';
  transform: rotate(45deg);
}

/* Tooltip positioning */
.tooltip[data-popper-placement^='top'] > .tooltip-arrow {
  bottom: -4px;
}

.tooltip[data-popper-placement^='bottom'] > .tooltip-arrow {
  top: -4px;
}

.tooltip[data-popper-placement^='left'] > .tooltip-arrow {
  right: -4px;
}

.tooltip[data-popper-placement^='right'] > .tooltip-arrow {
  left: -4px;
}

/*  Certainty and Importance gauge alignment. */

#page-metadata .page-metadata-fields .page-confidence,
#page-metadata .page-metadata-fields .page-importance {
  display: inline-flex;
  align-items: center;
  vertical-align: middle;
}

#page-metadata .page-metadata-fields .page-confidence svg,
#page-metadata .page-metadata-fields .page-importance svg {
  vertical-align: middle;
  margin-left: 0.15em;
}
